<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hyderabad Multimodal Transport Network - Complete Analysis Dashboard</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.98);
            padding: 2rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header h1 {
            color: #667eea;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            color: #666;
            font-size: 1.1rem;
        }
        
        .nav-tabs {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }
        
        .nav-tab {
            padding: 0.8rem 2rem;
            background: #f0f0f0;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .nav-tab:hover {
            background: #e0e0e0;
            transform: translateY(-2px);
        }
        
        .nav-tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .container {
            max-width: 1600px;
            margin: 2rem auto;
            padding: 0 2rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-label {
            color: #888;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #667eea;
            margin: 0.5rem 0;
        }
        
        .stat-description {
            color: #666;
            font-size: 0.9rem;
        }
        
        .chart-section {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .chart-title {
            font-size: 1.8rem;
            color: #667eea;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid #667eea;
        }
        
        .chart-container {
            width: 100%;
            height: 500px;
            margin-top: 1rem;
        }
        
        #network-map {
            width: 100%;
            height: 700px;
            border: 2px solid #ddd;
            border-radius: 10px;
            background: #fafafa;
        }
        
        .controls {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn {
            padding: 0.6rem 1.2rem;
            border: 2px solid #667eea;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .btn.active {
            background: #667eea;
            color: white;
        }
        
        .btn:hover {
            transform: scale(1.05);
        }
        
        select {
            padding: 0.6rem;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
        }
        
        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.8rem;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .legend-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #333;
        }
        
        .legend-line {
            width: 30px;
            height: 3px;
        }
        
        .info-box {
            background: linear-gradient(135deg, #667eea15, #764ba215);
            padding: 1.5rem;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            margin-top: 1.5rem;
        }
        
        .info-box h3 {
            color: #667eea;
            margin-bottom: 0.8rem;
        }
        
        .info-box ul {
            list-style: none;
            padding-left: 0;
        }
        
        .info-box li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }
        
        .info-box li::before {
            content: "to";
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: bold;
        }
        
        .transfer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .transfer-card {
            background: #f8f9fa;
            padding: 1.2rem;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .transfer-card h4 {
            color: #667eea;
            margin-bottom: 0.5rem;
        }
        
        .transfer-count {
            font-size: 1.8rem;
            font-weight: bold;
            color: #764ba2;
            margin: 0.5rem 0;
        }
        
        .footer {
            background: rgba(255, 255, 255, 0.95);
            padding: 2rem;
            text-align: center;
            margin-top: 3rem;
            color: #666;
        }

        /* Analytics Tab Styles */
        .section { 
            background: white; 
            border-radius: 15px; 
            padding: 30px; 
            margin-bottom: 30px; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.1); 
        }
        
        .section-title { 
            font-size: 1.8em; 
            color: #2c3e50; 
            margin-bottom: 25px; 
            border-bottom: 3px solid #667eea; 
            padding-bottom: 10px; 
        }
        
        .cards { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; 
        }
        
        .card { 
            background: white; 
            border-radius: 15px; 
            padding: 25px; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.1); 
            transition: transform 0.3s; 
        }
        
        .card:hover { 
            transform: translateY(-5px); 
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); 
        }
        
        .card-header { 
            display: flex; 
            align-items: center; 
            gap: 15px; 
            margin-bottom: 20px; 
        }
        
        .card-icon { 
            font-size: 2em; 
            width: 60px; 
            height: 60px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            border-radius: 12px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }
        
        .card-title { 
            font-size: 1.3em; 
            color: #2c3e50; 
            font-weight: 600; 
        }
        
        .card-subtitle { 
            font-size: 0.9em; 
            color: #95a5a6; 
        }
        
        .metric-row { 
            display: flex; 
            justify-content: space-between; 
            padding: 12px 0; 
            border-bottom: 1px solid #ecf0f1; 
        }
        
        .metric-row:last-child { 
            border-bottom: none; 
        }
        
        .metric-label { 
            color: #7f8c8d; 
        }
        
        .metric-value { 
            color: #2c3e50; 
            font-weight: 600; 
        }
        
        .badge { 
            margin-top: 15px; 
            padding: 8px 15px; 
            border-radius: 20px; 
            text-align: center; 
            font-weight: 600; 
            font-size: 0.85em; 
            text-transform: uppercase; 
        }
        
        .badge-high { 
            background: #fee; 
            color: #c0392b; 
        }
        
        .badge-medium { 
            background: #ffeaa7; 
            color: #d63031; 
        }
        
        .badge-low { 
            background: #d5f4e6; 
            color: #27ae60; 
        }
        
        .insight-box { 
            background: #f8f9fa; 
            border-left: 5px solid #667eea; 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 8px; 
        }
        
        .insight-title { 
            font-size: 1.2em; 
            font-weight: 600; 
            color: #2c3e50; 
            margin-bottom: 10px; 
        }
        
        .insight-text { 
            color: #555; 
            line-height: 1.8; 
        }
        
        .insight-text ul { 
            margin: 10px 0 10px 20px; 
        }
        
        .insight-text li { 
            margin: 5px 0; 
        }
        
        .rank-badge { 
            display: inline-block; 
            width: 28px; 
            height: 28px; 
            line-height: 28px; 
            text-align: center; 
            border-radius: 50%; 
            font-weight: bold; 
            color: white; 
        }
        
        .rank-1 { background: #f39c12; }
        .rank-2 { background: #95a5a6; }
        .rank-3 { background: #cd7f32; }
        .rank-other { background: #bdc3c7; color: #555; }
        
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 15px 0; 
        }
        
        th { 
            background: #3498db; 
            color: white; 
            padding: 12px; 
            text-align: left; 
        }
        
        td { 
            padding: 10px; 
            border-bottom: 1px solid #ecf0f1; 
        }
        
        tbody tr:hover { 
            background: #f8f9fa; 
        }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 1.8rem; }
            .stats-grid { grid-template-columns: 1fr; }
            .chart-container { height: 400px; }
            #network-map { height: 500px; }
            .cards { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Hyderabad Multimodal Transport Network</h1>
        <p>Complete Analysis Dashboard - Metro, MMTS, Bus & Auto Integration</p>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('overview')">Overview</button>
            <button class="nav-tab" onclick="switchTab('map')">Network Map</button>
            <button class="nav-tab" onclick="switchTab('transfers')">Transfers Explained</button>
            <button class="nav-tab" onclick="switchTab('analytics')">Analytics</button>
        </div>
    </div>

    <div class="container">
        <!-- TAB 1: OVERVIEW -->
        <div id="overview-tab" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total Nodes</div>
                    <div class="stat-value" id="total-nodes">675</div>
                    <div class="stat-description">Across 4 transport layers</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Edges</div>
                    <div class="stat-value" id="total-edges">6,868</div>
                    <div class="stat-description">Network connections</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Metro Stations</div>
                    <div class="stat-value">57</div>
                    <div class="stat-description">3 lines (Red, Blue, Green)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">MMTS Stations</div>
                    <div class="stat-value">46</div>
                    <div class="stat-description">Hyderabad only (filtered)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Bus Stops</div>
                    <div class="stat-value">200</div>
                    <div class="stat-description">Hybrid distribution</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Auto Stands</div>
                    <div class="stat-value" id="auto-count">372</div>
                    <div class="stat-description">Regional allocation</div>
                </div>
            </div>

            <div class="chart-section">
                <h2 class="chart-title">Hyderabad - 7 Transport Regions</h2>
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; margin-top: 1rem; align-items: start;">
                    <!-- Hyderabad Map -->
                    <div style="background: white; padding: 1rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <svg viewBox="0 0 600 700" style="width: 100%; height: auto; border: 2px solid #ddd; border-radius: 10px; background: linear-gradient(135deg, #e3f2fd 0%, #f5f5f5 100%);">
                            <!-- Map Title -->
                            <text x="300" y="30" text-anchor="middle" font-size="22" font-weight="bold" fill="#667eea">Hyderabad City - Regional Transport Zones</text>
                            
                            <!-- Outer Ring Road boundary (approximate) -->
                            <path d="M 100 150 Q 100 100, 150 100 L 450 100 Q 500 100, 500 150 L 500 550 Q 500 600, 450 600 L 150 600 Q 100 600, 100 550 Z" 
                                  fill="none" stroke="#999" stroke-width="2" stroke-dasharray="5,5" opacity="0.5"/>
                            <text x="520" y="350" font-size="11" fill="#999" transform="rotate(90, 520, 350)">Outer Ring Road</text>
                            
                            <!-- Major roads/landmarks indicators -->
                            <line x1="300" y1="100" x2="300" y2="600" stroke="#ccc" stroke-width="1" stroke-dasharray="3,3" opacity="0.4"/>
                            <line x1="100" y1="350" x2="500" y2="350" stroke="#ccc" stroke-width="1" stroke-dasharray="3,3" opacity="0.4"/>
                            
                            <!-- R5: Kukatpally/Northwest (Top Left) -->
                            <path d="M 120 140 L 120 220 L 250 220 L 250 140 Q 250 120, 230 120 L 140 120 Q 120 120, 120 140 Z" 
                                  fill="#4facfe" opacity="0.25" stroke="#4facfe" stroke-width="2.5"/>
                            <text x="185" y="165" text-anchor="middle" font-size="16" font-weight="bold" fill="#0066cc">R5</text>
                            <text x="185" y="183" text-anchor="middle" font-size="11" fill="#333" font-weight="600">Kukatpally</text>
                            <text x="185" y="197" text-anchor="middle" font-size="10" fill="#555">Northwest</text>
                            
                            <!-- R1: Secunderabad/North-Central (Top Center-Right) -->
                            <path d="M 260 140 Q 260 120, 280 120 L 430 120 Q 450 120, 450 140 L 450 240 L 350 240 L 260 240 Z" 
                                  fill="#667eea" opacity="0.25" stroke="#667eea" stroke-width="2.5"/>
                            <text x="355" y="165" text-anchor="middle" font-size="16" font-weight="bold" fill="#4a3399">R1</text>
                            <text x="355" y="183" text-anchor="middle" font-size="11" fill="#333" font-weight="600">Secunderabad</text>
                            <text x="355" y="197" text-anchor="middle" font-size="10" fill="#555">North-Central</text>
                            <circle cx="380" cy="210" r="4" fill="#E31E24" stroke="white" stroke-width="1"/>
                            <text x="390" y="213" font-size="8" fill="#666">Sec. Jn.</text>
                            
                            <!-- R4: HITEC City/West (Middle Left) -->
                            <path d="M 120 230 L 120 450 Q 120 470, 140 470 L 230 470 L 230 350 L 240 230 Z" 
                                  fill="#f093fb" opacity="0.25" stroke="#f093fb" stroke-width="2.5"/>
                            <text x="175" y="335" text-anchor="middle" font-size="16" font-weight="bold" fill="#c61aff">R4</text>
                            <text x="175" y="353" text-anchor="middle" font-size="11" fill="#333" font-weight="600">HITEC City</text>
                            <text x="175" y="367" text-anchor="middle" font-size="10" fill="#555">West</text>
                            <circle cx="200" cy="400" r="4" fill="#007ABB" stroke="white" stroke-width="1"/>
                            <text x="210" y="403" font-size="8" fill="#666">Hitec</text>
                            
                            <!-- R3: Deccan/South-Central (Center) -->
                            <path d="M 250 250 L 250 420 L 340 450 L 430 420 L 430 290 L 360 250 Z" 
                                  fill="#fa709a" opacity="0.25" stroke="#fa709a" stroke-width="2.5"/>
                            <text x="340" y="340" text-anchor="middle" font-size="16" font-weight="bold" fill="#cc0055">R3</text>
                            <text x="340" y="358" text-anchor="middle" font-size="11" fill="#333" font-weight="600">Deccan</text>
                            <text x="340" y="372" text-anchor="middle" font-size="10" fill="#555">South-Central</text>
                            <circle cx="320" cy="310" r="4" fill="#009846" stroke="white" stroke-width="1"/>
                            <text x="330" y="313" font-size="8" fill="#666">Ameerpet</text>
                            
                            <!-- R6: Uppal/East (Right) -->
                            <path d="M 440 250 L 480 250 Q 480 250, 480 270 L 480 450 Q 480 470, 460 470 L 440 470 L 440 430 Z" 
                                  fill="#00d2ff" opacity="0.25" stroke="#00d2ff" stroke-width="2.5"/>
                            <text x="460" y="345" text-anchor="middle" font-size="16" font-weight="bold" fill="#0099cc">R6</text>
                            <text x="460" y="363" text-anchor="middle" font-size="11" fill="#333" font-weight="600">Uppal</text>
                            <text x="460" y="377" text-anchor="middle" font-size="10" fill="#555">East</text>
                            <circle cx="465" cy="400" r="4" fill="#E31E24" stroke="white" stroke-width="1"/>
                            <text x="450" y="415" font-size="8" fill="#666">Uppal</text>
                            
                            <!-- R2: Old City/South (Bottom Center-Left) -->
                            <path d="M 240 480 L 140 480 Q 120 480, 120 500 L 120 560 Q 120 580, 140 580 L 310 580 L 330 540 L 350 460 Z" 
                                  fill="#764ba2" opacity="0.25" stroke="#764ba2" stroke-width="2.5"/>
                            <text x="230" y="520" text-anchor="middle" font-size="16" font-weight="bold" fill="#551177">R2</text>
                            <text x="230" y="538" text-anchor="middle" font-size="11" fill="#333" font-weight="600">Old City</text>
                            <text x="230" y="552" text-anchor="middle" font-size="10" fill="#555">South</text>
                            <circle cx="200" cy="530" r="4" fill="#009846" stroke="white" stroke-width="1"/>
                            <text x="210" y="533" font-size="8" fill="#666">Charminar</text>
                            
                            <!-- R7: LB Nagar/Periphery (Bottom Right) -->
                            <path d="M 360 470 L 340 550 L 320 580 L 420 580 Q 440 580, 440 560 L 440 500 Q 440 480, 420 480 Z" 
                                  fill="#8b5cf6" opacity="0.25" stroke="#8b5cf6" stroke-width="2.5"/>
                            <text x="380" y="520" text-anchor="middle" font-size="16" font-weight="bold" fill="#6a1b9a">R7</text>
                            <text x="380" y="538" text-anchor="middle" font-size="11" fill="#333" font-weight="600">LB Nagar</text>
                            <text x="380" y="552" text-anchor="middle" font-size="10" fill="#555">Periphery</text>
                            
                            <!-- Major water bodies (Hussain Sagar) -->
                            <ellipse cx="310" cy="190" rx="35" ry="20" fill="#4dd0e1" opacity="0.4" stroke="#00acc1" stroke-width="1"/>
                            <text x="310" y="194" text-anchor="middle" font-size="8" fill="#006064" font-weight="600">Hussain Sagar</text>
                            
                            <!-- Legend -->
                            <rect x="50" y="620" width="500" height="60" fill="white" opacity="0.9" stroke="#ddd" stroke-width="1" rx="8"/>
                            <text x="300" y="640" text-anchor="middle" font-size="11" font-weight="bold" fill="#667eea">Legend</text>
                            <circle cx="80" cy="660" r="3" fill="#E31E24"/>
                            <text x="90" y="663" font-size="9" fill="#666">Metro</text>
                            <circle cx="150" cy="660" r="3" fill="#007ABB"/>
                            <text x="160" y="663" font-size="9" fill="#666">Blue Line</text>
                            <circle cx="230" cy="660" r="3" fill="#009846"/>
                            <text x="240" y="663" font-size="9" fill="#666">Green Line</text>
                            <line x1="320" y1="660" x2="340" y2="660" stroke="#999" stroke-width="1" stroke-dasharray="5,5"/>
                            <text x="350" y="663" font-size="9" fill="#666">ORR</text>
                            <rect x="420" y="656" width="8" height="8" fill="#4dd0e1" opacity="0.6" stroke="#00acc1"/>
                            <text x="435" y="663" font-size="9" fill="#666">Water</text>
                        </svg>
                    </div>
                    
                    <!-- Region Names List -->
                    <div>
                        <h3 style="color: #667eea; margin-bottom: 1rem;">Regional Zones</h3>
                        <ul style="list-style: none; padding: 0;">
                            <li style="padding: 0.7rem; margin: 0.4rem 0; background: #f5f5f5; border-radius: 6px; border-left: 5px solid #667eea; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <strong style="color: #4a3399;">R1:</strong> Secunderabad/North-Central
                            </li>
                            <li style="padding: 0.7rem; margin: 0.4rem 0; background: #f5f5f5; border-radius: 6px; border-left: 5px solid #764ba2; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <strong style="color: #551177;">R2:</strong> Old City/South
                            </li>
                            <li style="padding: 0.7rem; margin: 0.4rem 0; background: #f5f5f5; border-radius: 6px; border-left: 5px solid #fa709a; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <strong style="color: #cc0055;">R3:</strong> Deccan/South-Central
                            </li>
                            <li style="padding: 0.7rem; margin: 0.4rem 0; background: #f5f5f5; border-radius: 6px; border-left: 5px solid #f093fb; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <strong style="color: #c61aff;">R4:</strong> HITEC City/West
                            </li>
                            <li style="padding: 0.7rem; margin: 0.4rem 0; background: #f5f5f5; border-radius: 6px; border-left: 5px solid #4facfe; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <strong style="color: #0066cc;">R5:</strong> Kukatpally/Northwest
                            </li>
                            <li style="padding: 0.7rem; margin: 0.4rem 0; background: #f5f5f5; border-radius: 6px; border-left: 5px solid #00d2ff; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <strong style="color: #0099cc;">R6:</strong> Uppal/East
                            </li>
                            <li style="padding: 0.7rem; margin: 0.4rem 0; background: #f5f5f5; border-radius: 6px; border-left: 5px solid #8b5cf6; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <strong style="color: #6a1b9a;">R7:</strong> LB Nagar/Periphery
                            </li>
                        </ul>
                        <div style="margin-top: 1.5rem; padding: 1rem; background: linear-gradient(135deg, #e3f2fd, #f3e5f5); border-radius: 8px; border: 1px solid #ddd;">
                            <p style="font-size: 0.9rem; color: #555; line-height: 1.6; margin: 0;">
                                <strong>Map Overview:</strong> The city is divided into 7 strategic transport zones covering major commercial, residential, and IT hubs. Each region is interconnected through multimodal transport networks.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="chart-section">
                <h2 class="chart-title">Network Composition</h2>
                <div id="composition-chart" class="chart-container"></div>
            </div>

            <div class="chart-section">
                <h2 class="chart-title">Edge Distribution by Mode</h2>
                <div id="edge-dist-chart" class="chart-container"></div>
            </div>

            <!-- ANALYTICS CONTENT MOVED FROM ANALYTICS TAB -->
            <!-- Connectivity Analysis -->
            <div class="chart-section">
                <h2 class="chart-title">Connectivity Analysis by Layer</h2>
                <div id="connectivity-chart" class="chart-container"></div>
                <p style="margin-top: 1rem; font-size: 0.95rem; color: #666;">
                    Shows minimum, maximum, average, and median edges per node for each transport layer.
                </p>
            </div>

            <!-- Regional Distribution -->
            <div class="chart-section">
                <h2 class="chart-title">Regional Distribution</h2>
                <div id="regional-chart" class="chart-container"></div>
                <p style="margin-top: 1rem; font-size: 0.95rem; color: #666;">
                    Distribution of transport nodes across 7 regions of Hyderabad.
                </p>
            </div>

            <!-- Metro Lines Analysis -->
            <div class="chart-section">
                <h2 class="chart-title">Metro Lines Analysis</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                    <div id="metro-stations-chart" class="chart-container"></div>
                    <div id="metro-length-chart" class="chart-container"></div>
                </div>
                <div class="info-box" style="margin-top: 1.5rem;">
                    <h3>Interchange Stations</h3>
                    <div id="interchange-list" style="margin-top: 1rem;"></div>
                </div>
            </div>

            <!-- MMTS CORRIDORS ANALYSIS -->
            <div class="chart-section">
                <h2 class="chart-title">MMTS Corridors Analysis</h2>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                    <!-- Corridor 1: Lingampalli-Falaknuma -->
                    <div style="background: linear-gradient(135deg, #fa709a 0%, #fc8181 100%); color: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 1rem;">
                            <div style="font-size: 2em;"></div>
                            <div>
                                <h3 style="margin: 0; font-size: 1.2em;">Lingampalli-Falaknuma</h3>
                                <p style="margin: 0; font-size: 0.9em; opacity: 0.9;">Main East-West Corridor</p>
                            </div>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 1rem; border-radius: 8px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span>Stations:</span>
                                <strong>25</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span>Approx Length:</span>
                                <strong>~55 km</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Key Hubs:</span>
                                <strong>HYB, SC, LPI</strong>
                            </div>
                        </div>
                        <p style="font-size: 0.85em; margin-top: 1rem; opacity: 0.95;">
                            Connects western suburbs (Lingampalli) to southeastern areas (Falaknuma), passing through central Hyderabad and Secunderabad.
                        </p>
                    </div>

                    <!-- Corridor 2: Secunderabad-Kacheguda -->
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 1rem;">
                            <div style="font-size: 2em;"></div>
                            <div>
                                <h3 style="margin: 0; font-size: 1.2em;">Secunderabad-Hyderabad-Kacheguda</h3>
                                <p style="margin: 0; font-size: 0.9em; opacity: 0.9;">Central City Link</p>
                            </div>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 1rem; border-radius: 8px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span>Stations:</span>
                                <strong>7</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span>Approx Length:</span>
                                <strong>~12 km</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Key Hubs:</span>
                                <strong>SC, HYB, KCG</strong>
                            </div>
                        </div>
                        <p style="font-size: 0.85em; margin-top: 1rem; opacity: 0.95;">
                            Critical link between twin cities' railway stations, serving dense urban core with high frequency service.
                        </p>
                    </div>

                    <!-- Corridor 3: Medchal-Secunderabad -->
                    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 1rem;">
                            <div style="font-size: 2em;"></div>
                            <div>
                                <h3 style="margin: 0; font-size: 1.2em;">Medchal-Secunderabad</h3>
                                <p style="margin: 0; font-size: 0.9em; opacity: 0.9;">Northern Corridor</p>
                            </div>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 1rem; border-radius: 8px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span>Stations:</span>
                                <strong>11</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span>Approx Length:</span>
                                <strong>~35 km</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Key Hubs:</span>
                                <strong>MED, MJF, SC</strong>
                            </div>
                        </div>
                        <p style="font-size: 0.85em; margin-top: 1rem; opacity: 0.95;">
                            Connects northern industrial/residential areas (Medchal) to Secunderabad junction via Malkajgiri.
                        </p>
                    </div>
                </div>

                <!-- MMTS Network Statistics -->
                <div style="background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%); padding: 2rem; border-radius: 12px; border-left: 5px solid #00acc1;">
                    <h3 style="color: #006064; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 1.5em;"></span> MMTS Network Overview
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem;">
                        <div style="background: white; padding: 1.2rem; border-radius: 10px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #00acc1;">46</div>
                            <div style="color: #666; margin-top: 0.5rem;">Total Stations</div>
                        </div>
                        <div style="background: white; padding: 1.2rem; border-radius: 10px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #00acc1;">132 km</div>
                            <div style="color: #666; margin-top: 0.5rem;">Total Network Length</div>
                        </div>
                        <div style="background: white; padding: 1.2rem; border-radius: 10px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #00acc1;">2.87 km</div>
                            <div style="color: #666; margin-top: 0.5rem;">Avg Station Spacing</div>
                        </div>
                        <div style="background: white; padding: 1.2rem; border-radius: 10px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #00acc1;">3</div>
                            <div style="color: #666; margin-top: 0.5rem;">Main Corridors</div>
                        </div>
                    </div>
                </div>

                <!-- MMTS Interchange Stations -->
                <div class="info-box" style="margin-top: 1.5rem;">
                    <h3 style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 1.5em;"></span> Major MMTS Interchange Stations
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; margin-top: 1rem;">
                        <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; border-left: 4px solid #fa709a;">
                            <strong style="color: #fa709a;">Secunderabad (SC_MMTS)</strong>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9em; color: #666;">
                                Central hub connecting all 3 corridors • Metro interchange • Major railway junction
                            </p>
                        </div>
                        <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; border-left: 4px solid #667eea;">
                            <strong style="color: #667eea;">Hyderabad (HYB_MMTS)</strong>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9em; color: #666;">
                                Historical railway station • Critical inter-regional hub • High betweenness centrality
                            </p>
                        </div>
                        <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; border-left: 4px solid #f093fb;">
                            <strong style="color: #f093fb;">Lingampalli (LPI_MMTS)</strong>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9em; color: #666;">
                                Western terminus • Metro interchange • IT corridor connection
                            </p>
                        </div>
                        <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; border-left: 4px solid #4facfe;">
                            <strong style="color: #4facfe;">Kacheguda (KCG_MMTS)</strong>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9em; color: #666;">
                                Southern gateway • Major railway station • Residential area hub
                            </p>
                        </div>
                    </div>
                </div>

                <!-- MMTS Key Facts -->
                <div style="background: linear-gradient(135deg, #fff9e6 0%, #ffe9b8 100%); padding: 1.5rem; border-radius: 12px; border-left: 5px solid #ffc107; margin-top: 1.5rem;">
                    <h3 style="color: #f57c00; margin-bottom: 1rem; display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 1.5em;"></span> MMTS Network Insights
                    </h3>
                    <ul style="line-height: 1.8; color: #555; margin: 0; padding-left: 1.5rem;">
                        <li><strong>Suburban Rail Service:</strong> MMTS serves as Hyderabad's suburban railway system, complementing the Metro for longer-distance commutes</li>
                        <li><strong>Regional Coverage:</strong> Majority of stations in R1 (14 stations) and R2 (10 stations), connecting eastern and central regions</li>
                        <li><strong>Integration with Metro:</strong> Key interchange points at Secunderabad, Lingampalli, and other stations enable seamless multi-modal travel</li>
                        <li><strong>Longer Station Spacing:</strong> 2.87 km average spacing (vs Metro's ~1.5 km) reflects suburban/regional service nature</li>
                        <li><strong>Critical Transfer Points:</strong> HYB_MMTS has highest betweenness centrality in entire network, indicating crucial routing importance</li>
                    </ul>
                </div>
            </div>

            <!-- Distance & Travel Analysis -->
            <div class="chart-section">
                <h2 class="chart-title">Distance & Travel Time Analysis</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                    <div id="distance-chart" class="chart-container"></div>
                    <div id="travel-time-chart" class="chart-container"></div>
                </div>
                
                <!-- Calculation Methodology -->
                <div class="info-box" style="margin-top: 1.5rem; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border-left: 5px solid #2196F3;">
                    <h3 style="color: #1565C0; display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 1.5em;"></span> Calculation Methodology
                    </h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1rem;">
                        <div>
                            <h4 style="color: #1976D2; margin-bottom: 0.5rem;">Average Edge Distance</h4>
                            <p style="font-size: 0.95em; line-height: 1.7; color: #333;">
                                <strong>Formula:</strong> Average distance between directly connected stations (intra-layer edges only)
                            </p>
                            <div style="background: white; padding: 0.8rem; border-radius: 5px; margin-top: 0.5rem; font-family: monospace; font-size: 0.9em;">
                                Avg Distance = Σ(edge distances) / count(edges)<br>
                                <span style="color: #666; font-size: 0.85em;">where edges are within same mode</span>
                            </div>
                            <p style="font-size: 0.85em; margin-top: 0.5rem; color: #555;">
                                <strong>Example:</strong> Metro avg = 1.06 km means typical distance between consecutive metro stations is 1.06 km
                            </p>
                        </div>
                        <div>
                            <h4 style="color: #1976D2; margin-bottom: 0.5rem;">Average Edge Travel Time</h4>
                            <p style="font-size: 0.95em; line-height: 1.7; color: #333;">
                                <strong>Formula:</strong> Average time to traverse a single edge (one segment between directly connected stations)
                            </p>
                            <div style="background: white; padding: 0.8rem; border-radius: 5px; margin-top: 0.5rem; font-family: monospace; font-size: 0.9em;">
                                Avg Time = Σ(edge travel times) / count(edges)<br>
                                <span style="color: #666; font-size: 0.85em;">Includes travel time + average wait/dwell time per segment</span>
                            </div>
                            <p style="font-size: 0.85em; margin-top: 0.5rem; color: #555;">
                                <strong>Note:</strong> This is per-segment time. Actual journey times involve multiple segments. Transfer time (5.6 min) includes walking time between modes at interchange points.
                            </p>
                        </div>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.7); padding: 1rem; border-radius: 8px; margin-top: 1rem; border-left: 3px solid #FF9800;">
                        <strong style="color: #E65100;">Key Insight:</strong>
                        <span style="color: #333;"> MMTS has longest average distance (2.87 km) and time (11.03 min) reflecting its suburban/regional service nature, while Bus and Auto provide shorter, more frequent connections for last-mile connectivity.</span>
                    </div>
                </div>
            </div>

            <!-- Top Connected Nodes -->
            <div class="chart-section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2 class="chart-title" style="margin: 0;">Network Node Connectivity Explorer</h2>
                    <div style="display: flex; gap: 1rem; align-items: center;">
                        <!-- Sort Direction Toggle -->
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <label style="font-weight: 600; color: #555;">View:</label>
                            <select id="sort-direction" style="padding: 0.5rem 1rem; border: 2px solid #667eea; border-radius: 5px; background: white; cursor: pointer; font-size: 0.95rem;">
                                <option value="desc">Most Connected</option>
                                <option value="asc">Least Connected</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Distribution Chart -->
                <div id="connectivity-distribution-chart" class="chart-container" style="margin-bottom: 2rem;"></div>
                
                <!-- Detailed Table -->
                <div id="connectivity-table-container" style="max-height: 500px; overflow-y: auto; border: 1px solid #ddd; border-radius: 8px;">
                    <table id="connectivity-table" style="width: 100%; border-collapse: collapse;">
                        <thead style="position: sticky; top: 0; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; z-index: 10;">
                            <tr>
                                <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #fff;">Connectivity</th>
                                <th style="padding: 1rem; text-align: center; border-bottom: 2px solid #fff;">Count</th>
                                <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #fff;">Nodes</th>
                            </tr>
                        </thead>
                        <tbody id="connectivity-table-body">
                            <!-- Will be populated dynamically -->
                        </tbody>
                    </table>
                </div>
                
                <div class="info-box" style="margin-top: 1.5rem; background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); border-left: 5px solid #FF6B6B;">
                    <div style="display: flex; align-items: start; gap: 1rem;">
                        <span style="font-size: 2em;"></span>
                        <div>
                            <h3 style="color: #c23616; margin: 0 0 0.5rem 0;">Understanding Node Connectivity</h3>
                            <p style="margin: 0; color: #333; line-height: 1.7;">
                                <strong>Most Connected Nodes:</strong> Critical hubs with many connections - key transfer points and central locations.<br>
                                <strong>Least Connected Nodes:</strong> Peripheral or endpoint stations - often terminals or isolated locations requiring transfers.<br>
                                <strong>Distribution View:</strong> Shows how many nodes have each connectivity level, revealing network structure patterns.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- NETWORK PERFORMANCE & EFFICIENCY METRICS -->
            <div class="chart-section">
                <h2 class="chart-title">Network Performance & Efficiency Metrics</h2>
                <p style="text-align: center; color: #666; margin-bottom: 2rem;">
                    Key performance indicators measuring network connectivity, accessibility, and structural quality
                </p>
                
                <!-- Performance Metrics Grid -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;" id="performance-metrics-grid">
                    <!-- Will be populated by JavaScript -->
                </div>
                
                <!-- Transfer Network Analysis -->
                <div style="margin-bottom: 2rem;">
                    <h3 class="chart-title" style="font-size: 1.3rem;">Inter-Modal Transfer Network</h3>
                    <div id="transfer-network-chart" class="chart-container"></div>
                </div>
                
                <!-- Rail Accessibility -->
                <div>
                    <h3 class="chart-title" style="font-size: 1.3rem;">Last-Mile Connectivity</h3>
                    <div id="accessibility-chart" class="chart-container"></div>
                </div>
                
                <div class="info-box" style="margin-top: 1.5rem; background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%); border-left: 5px solid #00acc1;">
                    <h3 style="color: #00838f;"> Network Quality Indicators</h3>
                    <ul id="quality-indicators" style="color: #333; line-height: 2;">
                        <!-- Will be populated dynamically -->
                    </ul>
                </div>
            </div>

            <!-- COMPLEX NETWORK ANALYSIS SECTION -->
            <div class="chart-section" style="margin-top: 3rem; border-top: 3px solid #667eea; padding-top: 2rem;">
                <h1 class="chart-title" style="font-size: 2rem; color: #667eea;">Complex Network Theory Analysis</h1>
                <p style="text-align: center; font-size: 1.1rem; color: #666; margin-bottom: 2rem;">
                    Advanced graph theory metrics revealing network structure and properties
                </p>

                <!-- Degree Distribution -->
                <div style="margin-bottom: 3rem;">
                    <h2 class="chart-title">Degree Distribution (Scale-Free Property)</h2>
                    <div id="degree-distribution-chart" class="chart-container"></div>
                    <div class="info-box" style="margin-top: 1rem;">
                        <p><strong>Interpretation:</strong> Degree distribution shows how connections are distributed across nodes. 
                        A power-law distribution indicates scale-free properties where few nodes (hubs) have many connections 
                        while most nodes have few connections - typical of real-world networks.</p>
                    </div>
                </div>

                <!-- Scale-Free Analysis Results -->
                <div style="margin-bottom: 3rem;">
                    <h2 class="chart-title">Scale-Free Network Test (Power-Law Analysis)</h2>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                        <div>
                            <div id="scale-free-verdict" class="info-box" style="text-align: center;">
                                <!-- Will be populated dynamically -->
                            </div>
                        </div>
                        <div>
                            <div class="info-box">
                                <h3>Statistical Measures</h3>
                                <div id="scale-free-stats" style="font-size: 1.05rem; line-height: 1.8;">
                                    <!-- Will be populated dynamically -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-box" style="margin-top: 1rem;">
                        <p><strong>Scale-Free Test:</strong> A rigorous statistical analysis to determine if the network follows a power-law degree distribution (P(k) ∝ k<sup>-γ</sup>). 
                        Scale-free networks are characterized by hub nodes with exceptionally high connectivity. Three criteria are tested:</p>
                        <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                            <li><strong>Gamma Range:</strong> Power-law exponent γ should be between 2 and 3 for typical scale-free networks</li>
                            <li><strong>Goodness of Fit:</strong> R² > 0.5 and RMSE < 0.1 indicate the data fits the power-law model well</li>
                            <li><strong>Kolmogorov-Smirnov Test:</strong> KS statistic < 0.15 confirms the distribution matches a power law</li>
                        </ul>
                        <p style="margin-top: 0.5rem;"><em>A network is classified as scale-free if it passes at least 2 out of 3 criteria.</em></p>
                    </div>
                </div>

                <!-- Comprehensive Network Classification -->
                <div style="margin-bottom: 3rem;">
                    <h2 class="chart-title"> Comprehensive Network Classification</h2>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                        <!-- Primary Classification -->
                        <div>
                            <div id="network-type-verdict" class="info-box" style="text-align: center; min-height: 250px;">
                                <!-- Populated dynamically -->
                            </div>
                        </div>
                        <!-- All Tests Summary -->
                        <div>
                            <div id="all-network-tests" class="info-box" style="min-height: 250px;">
                                <!-- Populated dynamically -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Network Comparison Visualization -->
                    <div style="text-align: center; margin: 2rem 0;">
                        <img src="network_classification_plots.png" alt="Network Classification Comparison" 
                             style="max-width: 100%; height: auto; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                    </div>
                    
                    <div class="info-box">
                        <h3>What This Means:</h3>
                        <div id="classification-explanation">
                            <!-- Populated dynamically based on classification -->
                        </div>
                    </div>
                </div>

                <!-- Clustering Coefficient & Small-World Confirmed -->
                <div style="margin-bottom: 3rem;">
                    <h2 class="chart-title"> Small-World Network Confirmed: Clustering & Path Length Analysis</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                        <div>
                            <div id="clustering-chart" class="chart-container"></div>
                        </div>
                        <div>
                            <div class="info-box">
                                <h3> Small-World Properties Verified</h3>
                                <div id="small-world-metrics" style="font-size: 1.1rem; line-height: 1.8;">
                                    <!-- Will be populated dynamically -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-box" style="margin-top: 1rem; background: linear-gradient(135deg, #e8f5e9 0%, #f1f8e9 100%); border-left: 5px solid #4caf50;">
                        <h3 style="color: #2e7d32; margin-bottom: 1rem;"> Why Your Network is Small-World:</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1rem;">
                            <div>
                                <h4 style="color: #4caf50; margin-bottom: 0.5rem;"> High Clustering</h4>
                                <p><strong>Your Network:</strong> <span id="sw-clustering-value">0.5241</span></p>
                                <p><strong>Random Network:</strong> <span id="sw-random-clustering">0.0302</span></p>
                                <p><strong>Ratio:</strong> <span id="sw-clustering-ratio" style="color: #2e7d32; font-weight: bold;">17.36x higher!</span></p>
                                <p style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                                    <em>Neighborhoods are tightly connected - strong local community structure</em>
                                </p>
                            </div>
                            <div>
                                <h4 style="color: #4caf50; margin-bottom: 0.5rem;"> Efficient Paths</h4>
                                <p><strong>Your Network:</strong> <span id="sw-path-value">8.65</span> hops</p>
                                <p><strong>Random Network:</strong> <span id="sw-random-path">2.81</span> hops</p>
                                <p><strong>Ratio:</strong> <span id="sw-path-ratio" style="color: #2e7d32; font-weight: bold;">3.08x longer</span></p>
                                <p style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                                    <em>Paths are longer than random but still efficient - typical of small-world</em>
                                </p>
                            </div>
                        </div>
                        <div style="background: white; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                            <h4 style="color: #4caf50; margin-bottom: 0.5rem;"> Small-World Sigma (σ) = <span id="sw-sigma-value" style="font-size: 1.3rem;">5.63</span></h4>
                            <p><strong>Formula:</strong> σ = (C<sub>real</sub> / C<sub>random</sub>) / (L<sub>real</sub> / L<sub>random</sub>)</p>
                            <p><strong>Interpretation:</strong> σ > 1 indicates small-world. Your σ = <span id="sw-sigma-value-2">5.63</span> is <strong>strongly small-world!</strong></p>
                            <p style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                                This means clustering is 5.6x higher than expected for the path lengths you have - the hallmark of small-world networks.
                            </p>
                        </div>
                        <div style="margin-top: 1rem; padding: 1rem; background: #fff3e0; border-radius: 8px;">
                            <h4 style="color: #f57c00;"> What This Means for Transportation:</h4>
                            <ul style="margin-top: 0.5rem; line-height: 1.8;">
                                <li><strong>Local Efficiency:</strong> Neighborhoods have excellent internal connectivity</li>
                                <li><strong>Global Reach:</strong> Can still reach distant areas in ~9 transfers</li>
                                <li><strong>Resilience:</strong> Multiple redundant paths between locations</li>
                                <li><strong>Natural Structure:</strong> Emerges in well-designed urban systems</li>
                                <li><strong>Real-World Parallels:</strong> Similar to social networks, brain networks, power grids</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- COMPREHENSIVE CENTRALITY ANALYSIS -->
                <div style="margin-bottom: 3rem;">
                    <h2 class="chart-title"> Comprehensive Centrality Analysis</h2>
                    <p style="text-align: center; color: #666; margin-bottom: 2rem;">
                        Identifying critical nodes through 5 different centrality measures
                    </p>
                    
                    <!-- 1. DEGREE CENTRALITY -->
                    <div style="margin-bottom: 3rem; background: linear-gradient(135deg, #667eea15, #764ba215); padding: 2rem; border-radius: 12px;">
                        <h3 style="color: #667eea; margin-bottom: 1rem;"> 1. Degree Centrality</h3>
                        
                        <div class="info-box" style="margin-bottom: 1.5rem;">
                            <p><strong>Definition:</strong> Measures the number of direct connections a node has. Nodes with high degree centrality are hubs with many direct links.</p>
                            <p style="margin-top: 0.5rem;"><strong>Formula:</strong></p>
                            <div style="background: white; padding: 1rem; border-radius: 8px; font-family: 'Courier New', monospace; margin-top: 0.5rem;">
                                C<sub>D</sub>(v) = deg(v) / (n - 1)
                            </div>
                            <p style="margin-top: 0.5rem; font-size: 0.9rem;"><em>where deg(v) = number of edges connected to node v, n = total nodes</em></p>
                            <p style="margin-top: 1rem;"><strong>Transport Significance:</strong> High-degree stations serve as major transfer hubs connecting multiple routes. Essential for network accessibility.</p>
                        </div>
                        
                        <div>
                            <h4 style="text-align: center; color: #667eea;">Top 10 Nodes by Degree Centrality</h4>
                            <div id="degree-top-chart" class="chart-container"></div>
                        </div>
                    </div>
                    
                    <!-- 2. BETWEENNESS CENTRALITY -->
                    <div style="margin-bottom: 3rem; background: linear-gradient(135deg, #fa709a15, #fee14015); padding: 2rem; border-radius: 12px;">
                        <h3 style="color: #fa709a; margin-bottom: 1rem;"> 2. Betweenness Centrality</h3>
                        
                        <div class="info-box" style="margin-bottom: 1.5rem;">
                            <p><strong>Definition:</strong> Measures how often a node lies on the shortest paths between other node pairs. High betweenness nodes are critical bridges.</p>
                            <p style="margin-top: 0.5rem;"><strong>Formula:</strong></p>
                            <div style="background: white; padding: 1rem; border-radius: 8px; font-family: 'Courier New', monospace; margin-top: 0.5rem;">
                                C<sub>B</sub>(v) = Σ [σ<sub>st</sub>(v) / σ<sub>st</sub>] for all s,t pairs
                            </div>
                            <p style="margin-top: 0.5rem; font-size: 0.9rem;"><em>where σ<sub>st</sub> = total number of shortest paths from s to t, σ<sub>st</sub>(v) = paths passing through v</em></p>
                            <p style="margin-top: 1rem;"><strong>Transport Significance:</strong> Critical bottleneck points. Their removal severely impacts network flow and passenger routing.</p>
                        </div>
                        
                        <div>
                            <h4 style="text-align: center; color: #fa709a;">Top 10 Nodes by Betweenness Centrality</h4>
                            <div id="betweenness-top-chart" class="chart-container"></div>
                        </div>
                    </div>
                    
                    <!-- 3. CLOSENESS CENTRALITY -->
                    <div style="margin-bottom: 3rem; background: linear-gradient(135deg, #4facfe15, #00f2fe15); padding: 2rem; border-radius: 12px;">
                        <h3 style="color: #4facfe; margin-bottom: 1rem;"> 3. Closeness Centrality</h3>
                        
                        <div class="info-box" style="margin-bottom: 1.5rem;">
                            <p><strong>Definition:</strong> Measures the average distance from a node to all other nodes. High closeness means short average paths to everywhere.</p>
                            <p style="margin-top: 0.5rem;"><strong>Formula:</strong></p>
                            <div style="background: white; padding: 1rem; border-radius: 8px; font-family: 'Courier New', monospace; margin-top: 0.5rem;">
                                C<sub>C</sub>(v) = (n - 1) / Σ d(v, u) for all u
                            </div>
                            <p style="margin-top: 0.5rem; font-size: 0.9rem;"><em>where d(v,u) = shortest distance from v to u, n = total nodes</em></p>
                            <p style="margin-top: 1rem;"><strong>Transport Significance:</strong> Centrally located nodes with efficient access to entire network. Ideal for service centers or emergency response stations.</p>
                        </div>
                        
                        <div>
                            <h4 style="text-align: center; color: #4facfe;">Top 10 Nodes by Closeness Centrality</h4>
                            <div id="closeness-top-chart" class="chart-container"></div>
                        </div>
                    </div>
                    
                    <!-- 4. EIGENVECTOR CENTRALITY -->
                    <div style="margin-bottom: 3rem; background: linear-gradient(135deg, #f093fb15, #f5576c15); padding: 2rem; border-radius: 12px;">
                        <h3 style="color: #f093fb; margin-bottom: 1rem;"> 4. Eigenvector Centrality</h3>
                        
                        <div class="info-box" style="margin-bottom: 1.5rem;">
                            <p><strong>Definition:</strong> Measures influence based on the quality of connections. Nodes connected to important nodes have high eigenvector centrality.</p>
                            <p style="margin-top: 0.5rem;"><strong>Formula:</strong></p>
                            <div style="background: white; padding: 1rem; border-radius: 8px; font-family: 'Courier New', monospace; margin-top: 0.5rem;">
                                x<sub>v</sub> = (1/λ) × Σ x<sub>u</sub> for all neighbors u
                            </div>
                            <p style="margin-top: 0.5rem; font-size: 0.9rem;"><em>where λ = largest eigenvalue, x<sub>u</sub> = centrality of neighbor u (computed iteratively)</em></p>
                            <p style="margin-top: 1rem;"><strong>Transport Significance:</strong> Stations connected to other important hubs. High strategic value for network-wide service improvements.</p>
                        </div>
                        
                        <div>
                            <h4 style="text-align: center; color: #f093fb;">Top 10 Nodes by Eigenvector Centrality</h4>
                            <div id="eigenvector-top-chart" class="chart-container"></div>
                        </div>
                    </div>
                    
                    <!-- 5. CLUSTERING COEFFICIENT -->
                    <div style="margin-bottom: 3rem; background: linear-gradient(135deg, #ffecd215, #fcb69f15); padding: 2rem; border-radius: 12px;">
                        <h3 style="color: #fcb69f; margin-bottom: 1rem;"> 5. Clustering Coefficient</h3>
                        
                        <div class="info-box" style="margin-bottom: 1.5rem;">
                            <p><strong>Definition:</strong> Measures how interconnected a node's neighbors are. High clustering means neighbors form tightly-knit groups.</p>
                            <p style="margin-top: 0.5rem;"><strong>Formula:</strong></p>
                            <div style="background: white; padding: 1rem; border-radius: 8px; font-family: 'Courier New', monospace; margin-top: 0.5rem;">
                                C(v) = 2 × T(v) / [k<sub>v</sub> × (k<sub>v</sub> - 1)]
                            </div>
                            <p style="margin-top: 0.5rem; font-size: 0.9rem;"><em>where T(v) = number of triangles through v, k<sub>v</sub> = degree of v</em></p>
                            <p style="margin-top: 1rem;"><strong>Transport Significance:</strong> High clustering indicates strong local redundancy. Multiple alternative routes between nearby locations provide resilience.</p>
                        </div>
                        
                        <div>
                            <h4 style="text-align: center; color: #fcb69f;">Top 10 Nodes by Clustering Coefficient</h4>
                            <div id="clustering-top-chart" class="chart-container"></div>
                        </div>
                    </div>
                </div>

                <!-- COMPREHENSIVE NETWORK STATISTICS & METRICS -->
                <div class="info-box" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 2.5rem; margin-top: 3rem;">
                    <h2 style="color: white; margin-bottom: 2rem; font-size: 1.8rem; text-align: center;">Network Statistics & Complex Properties</h2>
                    
                    <!-- Key Metrics Grid -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                        <div style="background: rgba(255,255,255,0.15); padding: 1.5rem; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2.5rem; font-weight: bold; color: #fff;">675</div>
                            <div style="font-size: 1rem; margin-top: 0.5rem; opacity: 0.9;">Total Nodes</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 1.5rem; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2.5rem; font-weight: bold; color: #fff;">6,868</div>
                            <div style="font-size: 1rem; margin-top: 0.5rem; opacity: 0.9;">Total Edges</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 1.5rem; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2.5rem; font-weight: bold; color: #fff;">20.35</div>
                            <div style="font-size: 1rem; margin-top: 0.5rem; opacity: 0.9;">Avg Degree</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 1.5rem; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2.5rem; font-weight: bold; color: #fff;">0.5241</div>
                            <div style="font-size: 1rem; margin-top: 0.5rem; opacity: 0.9;">Clustering</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 1.5rem; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2.5rem; font-weight: bold; color: #fff;">8.71</div>
                            <div style="font-size: 1rem; margin-top: 0.5rem; opacity: 0.9;">Avg Path Length</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 1.5rem; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2.5rem; font-weight: bold; color: #fff;">23</div>
                            <div style="font-size: 1rem; margin-top: 0.5rem; opacity: 0.9;">Diameter</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 1.5rem; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2.5rem; font-weight: bold; color: #fff;">0.205</div>
                            <div style="font-size: 1rem; margin-top: 0.5rem; opacity: 0.9;">Assortativity</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 1.5rem; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2.5rem; font-weight: bold; color: #fff;">44.5%</div>
                            <div style="font-size: 1rem; margin-top: 0.5rem; opacity: 0.9;">Transfer Edges</div>
                        </div>
                    </div>

                    <!-- Network Classification Highlight -->
                    <div style="background: rgba(255,255,255,0.2); padding: 1.5rem; border-radius: 10px; border-left: 4px solid #ffd700;">
                        <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap;">
                            <div>
                                <div style="font-size: 1.3rem; font-weight: bold; margin-bottom: 0.5rem;">Network Type: SMALL-WORLD</div>
                                <div style="font-size: 1rem; opacity: 0.9;">Small-world coefficient (σ) = 5.63 (highly clustered with short paths)</div>
                            </div>
                            <div style="text-align: right; margin-top: 1rem;">
                                <div style="font-size: 0.9rem; opacity: 0.85;">High clustering (17.36× random) • Short paths (3.08× random)</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 2: NETWORK MAP -->
        <div id="map-tab" class="tab-content">
            <div class="chart-section">
                <h2 class="chart-title">Interactive Network Visualization</h2>
                
                <div class="controls">
                    <div class="control-group">
                        <label><strong>Show Layers:</strong></label>
                        <button class="btn active" onclick="toggleLayer('metro')">Metro</button>
                        <button class="btn active" onclick="toggleLayer('mmts')">MMTS</button>
                        <button class="btn active" onclick="toggleLayer('bus')">Bus</button>
                        <button class="btn active" onclick="toggleLayer('auto')">Auto</button>
                    </div>
                    
                    <div class="control-group">
                        <label><strong>Edge Type:</strong></label>
                        <select id="edge-filter" onchange="filterEdges()">
                            <option value="all">All Edges</option>
                            <option value="transfer">Only Transfers (Inter-Layer)</option>
                            <option value="intra">Only Intra-Layer</option>
                            <option value="metro">Metro Lines</option>
                            <option value="mmts">MMTS Corridors</option>
                            <option value="bus">Bus Routes</option>
                            <option value="auto">Auto Network</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label><strong>Sample Size:</strong></label>
                        <select id="sample-size" onchange="changeSampleSize()">
                            <option value="50">50 nodes (Fast)</option>
                            <option value="100" selected>100 nodes (Balanced)</option>
                            <option value="200">200 nodes (Detailed)</option>
                            <option value="all">All 675 nodes (Slow)</option>
                        </select>
                    </div>
                </div>

                <div id="network-map"></div>

                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-dot" style="background: #764ba2;"></div>
                        <span><strong>Metro (57)</strong> - Purple dots</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot" style="background: #fa709a;"></div>
                        <span><strong>MMTS (46)</strong> - Pink dots</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot" style="background: #f093fb;"></div>
                        <span><strong>Bus (200)</strong> - Light purple dots</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot" style="background: #4facfe;"></div>
                        <span><strong>Auto (372)</strong> - Blue dots</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-line" style="background: #667eea;"></div>
                        <span><strong>Transfer</strong> - Dashed blue</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 3: TRANSFERS EXPLAINED -->
        <div id="transfers-tab" class="tab-content">
            <div class="chart-section">
                <h2 class="chart-title">What are "Transfer" Edges?</h2>
                <p style="font-size: 1.1rem; line-height: 1.8; margin-bottom: 1.5rem;">
                    <strong>Transfer edges</strong> (also called "inter-layer" edges) are connections that allow passengers 
                    to <strong>switch between different transport modes</strong>. They represent walking from one mode to another 
                    at a common location. In our network, <strong><span id="transfer-stats">3,068 out of 6,283 edges (49%)</span> are transfers</strong>, showing 
                    how integrated the multimodal system is!
                </p>

                <div class="transfer-grid" id="transfer-breakdown">
                    <!-- Transfer cards will be loaded here by JavaScript -->
                </div>

                <div class="info-box">
                    <h3>Why So Many Transfers?</h3>
                    <ul>
                        <li><strong>First/Last Mile Connectivity:</strong> Metro and MMTS are fixed rail lines. Passengers need buses and autos to reach their final destination from the nearest station.</li>
                        <li><strong>Network Integration:</strong> Transfers enable the 4 layers to work together as one unified system, not isolated networks.</li>
                        <li><strong>No Direct Metro-MMTS:</strong> By design constraint, passengers must transfer via bus/auto at major hubs like Secunderabad.</li>
                        <li><strong>High count = Good coverage:</strong> More transfer options mean more route flexibility and better accessibility for passengers.</li>
                        <li><strong>Realistic modeling:</strong> Real passengers often combine 2-3 modes per journey (e.g., Auto to MMTS to Bus to destination).</li>
                    </ul>
                </div>

                <div class="chart-section">
                    <h3 style="color: #667eea; margin-bottom: 1rem;">Sample Journey with Transfers</h3>
                    <p><strong>Route:</strong> Uppal (East) to Ameerpet (Central)</p>
                    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px; margin-top: 1rem;">
                        <div style="padding: 0.8rem; border-left: 4px solid #4facfe; margin: 0.5rem 0;">
                            <strong>1. Start:</strong> Uppal_Auto_Stand <span style="background: #4facfe; color: white; padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.8rem;">AUTO</span>
                        </div>
                        <div style="padding: 0.5rem; text-align: center; color: #667eea;">
                             Auto (1.2 km, 8 min, ₹46) - <span style="background: #667eea; color: white; padding: 0.2rem 0.6rem; border-radius: 10px; font-size: 0.75rem;">TRANSFER 1</span>
                        </div>
                        <div style="padding: 0.8rem; border-left: 4px solid #fa709a; margin: 0.5rem 0;">
                            <strong>2. Transfer:</strong> Uppal MMTS Station <span style="background: #fa709a; color: white; padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.8rem;">MMTS</span>
                        </div>
                        <div style="padding: 0.5rem; text-align: center; color: #667eea;">
                             MMTS Train (13.4 km, 35 min, ₹25)
                        </div>
                        <div style="padding: 0.8rem; border-left: 4px solid #fa709a; margin: 0.5rem 0;">
                            <strong>3. Arrive:</strong> Secunderabad MMTS <span style="background: #fa709a; color: white; padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.8rem;">MMTS</span>
                        </div>
                        <div style="padding: 0.5rem; text-align: center; color: #667eea;">
                             Walk (0.8 km, 10 min) - <span style="background: #667eea; color: white; padding: 0.2rem 0.6rem; border-radius: 10px; font-size: 0.75rem;">TRANSFER 2</span>
                        </div>
                        <div style="padding: 0.8rem; border-left: 4px solid #f093fb; margin: 0.5rem 0;">
                            <strong>4. Transfer:</strong> Secunderabad Bus Hub <span style="background: #f093fb; color: white; padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.8rem;">BUS</span>
                        </div>
                        <div style="padding: 0.5rem; text-align: center; color: #667eea;">
                             Bus (11.2 km, 38 min, ₹22) - <span style="background: #667eea; color: white; padding: 0.2rem 0.6rem; border-radius: 10px; font-size: 0.75rem;">TRANSFER 3</span>
                        </div>
                        <div style="padding: 0.8rem; border-left: 4px solid #764ba2; margin: 0.5rem 0;">
                            <strong>5. Destination:</strong> Ameerpet Metro Station <span style="background: #764ba2; color: white; padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.8rem;">METRO</span>
                        </div>
                    </div>
                    <p style="margin-top: 1rem; padding: 1rem; background: #fff3cd; border-radius: 8px; border-left: 4px solid #ffc107;">
                        <strong>Notice:</strong> This journey uses <strong>3 transfers</strong> (AutotoMMTS, MMTStoBus, BustoMetro). 
                        These are the "transfer edges" that make up 55% of our network!
                    </p>
                </div>
            </div>
        </div>

        <!-- TAB 4: ANALYTICS -->
        <div id="analytics-tab" class="tab-content">
            
            <!-- Classification -->
            <div class="section" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <h2 class="section-title" style="color: white; border-bottom: 3px solid rgba(255,255,255,0.3);">Network Classification</h2>

                <div style="background: rgba(255,255,255,0.95); color: #333; padding: 25px; border-radius: 12px;">
                    <h3 style="margin-bottom: 15px;">SMALL-WORLD TRANSPORT NETWORK</h3>
                    <p style="font-size: 1.1em; margin: 15px 0;">
                        Multi-modal urban transport with high clustering, short paths, and strong community structure.
                    </p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin-top: 20px;">
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #27ae60;">
                            <div style="font-size: 0.9em; color: #7f8c8d;">Small-World Property</div>
                            <div style="font-size: 1.5em; font-weight: bold; margin: 5px 0; color: #27ae60;">YES </div>
                            <div style="font-size: 0.85em; color: #666;">σ = 5.51 (high clustering + short paths)</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #27ae60;">
                            <div style="font-size: 0.9em; color: #7f8c8d;">Modularity</div>
                            <div style="font-size: 1.5em; font-weight: bold; margin: 5px 0;">0.792</div>
                            <div style="font-size: 0.85em; color: #666;">Very High - 9 geographical communities</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #27ae60;">
                            <div style="font-size: 0.9em; color: #7f8c8d;">Clustering Coefficient</div>
                            <div style="font-size: 1.5em; font-weight: bold; margin: 5px 0;">0.524</div>
                            <div style="font-size: 0.85em; color: #666;">High local connectivity (neighbors connect)</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Properties Cards -->
            <div class="cards" style="margin-bottom: 30px; grid-template-columns: repeat(4, 1fr) !important;">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon"></div>
                        <div>
                            <div class="card-title">Basic Properties</div>
                            <div class="card-subtitle">Fundamentals</div>
                        </div>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Density</span>
                        <span class="metric-value">3.02%</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Average Degree</span>
                        <span class="metric-value">20.35</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Connected</span>
                        <span class="metric-value">YES</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Planar</span>
                        <span class="metric-value">NO</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon"></div>
                        <div>
                            <div class="card-title">Path Analysis</div>
                            <div class="card-subtitle">Distance metrics</div>
                        </div>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Avg Shortest Path</span>
                        <span class="metric-value">8.82 hops</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Diameter</span>
                        <span class="metric-value">24 hops</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Radius</span>
                        <span class="metric-value">13 hops</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Avg Eccentricity</span>
                        <span class="metric-value">17.75</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon"></div>
                        <div>
                            <div class="card-title">Efficiency</div>
                            <div class="card-subtitle">Performance</div>
                        </div>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Global Efficiency</span>
                        <span class="metric-value">0.160</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Local Efficiency</span>
                        <span class="metric-value">0.707</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Algebraic Connect.</span>
                        <span class="metric-value">0.0165</span>
                    </div>
                    <div class="badge badge-medium">MODERATE</div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon"></div>
                        <div>
                            <div class="card-title">Centrality</div>
                            <div class="card-subtitle">Averages</div>
                        </div>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Avg Degree</span>
                        <span class="metric-value">0.0151</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Avg Betweenness</span>
                        <span class="metric-value">0.0116</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Avg Closeness</span>
                        <span class="metric-value">0.1184</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Assortativity</span>
                        <span class="metric-value">0.205</span>
                    </div>
                    <div style="font-size: 0.85em; color: #155724; margin-top: 8px; padding: 8px; background: #d4edda; border-radius: 5px; border-left: 3px solid #28a745;">
                        <strong>r = 0.205 > 0:</strong> Assortative - high-degree nodes connect to other high-degree nodes
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon"></div>
                        <div>
                            <div class="card-title">Communities</div>
                            <div class="card-subtitle">Structure</div>
                        </div>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Communities</span>
                        <span class="metric-value">9</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Modularity</span>
                        <span class="metric-value">0.792</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Avg Size</span>
                        <span class="metric-value">75 nodes</span>
                    </div>
                    <div class="badge badge-low">VERY HIGH</div>
                    <div style="font-size: 0.85em; color: #721c24; margin-top: 8px; padding: 8px; background: #f8d7da; border-radius: 5px; border-left: 3px solid #dc3545;">
                        <strong>Q = 0.792 > 0.7:</strong> Very strong community structure (8-146 nodes/group)
                    </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon"></div>
                        <div>
                            <div class="card-title">Degree Dist.</div>
                            <div class="card-subtitle">Topology</div>
                        </div>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Max Degree</span>
                        <span class="metric-value">33</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Median</span>
                        <span class="metric-value">10.0</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Std Dev</span>
                        <span class="metric-value">4.26</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Type</span>
                        <span class="metric-value">Not Power-Law</span>
                    </div>
                </div>
            </div>

            <!-- FORMULA REFERENCE BOX -->
            <div class="section" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
                <h2 class="section-title" style="color: white; border-bottom: 3px solid rgba(255,255,255,0.3); cursor: pointer;" onclick="toggleFormulas()">
                     Formula Reference <span id="formula-toggle" style="font-size: 0.8em;">[Click to Expand]</span>
                </h2>

                <div id="formula-content" style="display: none; background: rgba(255,255,255,0.95); color: #333; padding: 25px; border-radius: 12px;">
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
                        
                        <!-- Basic Properties -->
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #3498db;">
                            <h3 style="color: #3498db; margin-bottom: 10px;">Basic Properties</h3>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Density:</strong> ρ = 2m / [n(n-1)]
                            </p>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Avg Degree:</strong> k̄ = 2m / n
                            </p>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Planar Test:</strong> m > 3n - 6 to edges cross
                            </p>
                            <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                                Where: n = nodes, m = edges
                            </p>
                        </div>

                        <!-- Connectivity -->
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #e74c3c;">
                            <h3 style="color: #e74c3c; margin-bottom: 10px;">Connectivity</h3>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Node Connectivity:</strong> κ(G) = min nodes to disconnect
                            </p>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Edge Connectivity:</strong> λ(G) = min edges to disconnect
                            </p>
                            <p style="font-size: 0.85em; color: #e74c3c; margin-top: 10px; background: #f8d7da; padding: 8px; border-radius: 5px;">
                                 <strong>Min-cut algorithm</strong> finds STRATEGIC nodes, not high-degree nodes!
                            </p>
                        </div>

                        <!-- Path Metrics -->
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #9b59b6;">
                            <h3 style="color: #9b59b6; margin-bottom: 10px;">Path Analysis</h3>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Avg Shortest Path:</strong> L = Σd(i,j) / [n×(n-1)]
                            </p>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Diameter:</strong> max{d(i,j)} for all pairs
                            </p>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Radius:</strong> min{ecc(v)} where ecc = max distance from v
                            </p>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Bound:</strong> Radius ≤ Diameter ≤ 2×Radius
                            </p>
                            <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                                Where: d(i,j) = shortest path, ecc(v) = eccentricity
                            </p>
                        </div>

                        <!-- Efficiency -->
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #f39c12;">
                            <h3 style="color: #f39c12; margin-bottom: 10px;">Efficiency</h3>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Global Efficiency:</strong> E<sub>global</sub> = Σ(1/d(i,j)) / [n×(n-1)]
                            </p>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Local Efficiency:</strong> E<sub>local</sub> = (1/n) × Σ E<sub>global</sub>(neighbors<sub>i</sub>)
                            </p>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Algebraic Connectivity:</strong> λ₂ of Laplacian (L = D - A)
                            </p>
                            <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                                Where: D = degree matrix, A = adjacency matrix
                            </p>
                        </div>

                        <!-- Centrality -->
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #16a085;">
                            <h3 style="color: #16a085; margin-bottom: 10px;">Centrality</h3>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Degree Centrality:</strong> C<sub>D</sub>(v) = deg(v) / (n-1)
                            </p>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Betweenness:</strong> C<sub>B</sub>(v) = Σ(σ<sub>st</sub>(v) / σ<sub>st</sub>)
                            </p>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Closeness:</strong> C<sub>C</sub>(v) = (n-1) / Σd(v,u)
                            </p>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Assortativity:</strong> r = Pearson corr(deg<sub>i</sub>, deg<sub>j</sub>)
                            </p>
                            <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                                Where: σ<sub>st</sub>(v) = shortest paths through v
                            </p>
                        </div>

                        <!-- Communities -->
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #8e44ad;">
                            <h3 style="color: #8e44ad; margin-bottom: 10px;">Communities</h3>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Modularity:</strong> Q = Σ[A<sub>ij</sub> - (k<sub>i</sub>×k<sub>j</sub>)/(2m)] × δ(c<sub>i</sub>,c<sub>j</sub>) / (2m)
                            </p>
                            <p style="margin: 8px 0; font-size: 0.9em;">
                                <strong>Detection:</strong> Greedy modularity optimization
                            </p>
                            <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                                Where: δ(c<sub>i</sub>,c<sub>j</sub>) = 1 if same community, 0 otherwise
                            </p>
                        </div>

                        <!-- Degree Distribution -->
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #2c3e50;">
                            <h3 style="color: #2c3e50; margin-bottom: 10px;">Degree Distribution</h3>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Max Degree:</strong> max{deg(v)} for all v
                            </p>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Std Dev:</strong> σ = √[Σ(deg<sub>i</sub> - k̄)² / n]
                            </p>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Power Law Test:</strong> P(k) ∝ k<sup>-γ</sup> (scale-free)
                            </p>
                            <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                                Our network: NOT power-law (small-world instead)
                            </p>
                        </div>

                        <!-- Small-World -->
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #27ae60;">
                            <h3 style="color: #27ae60; margin-bottom: 10px;">Small-World Property</h3>
                            <p style="margin: 8px 0; font-family: 'Courier New', monospace; font-size: 0.95em;">
                                <strong>Small-World Coefficient:</strong> σ = (C/C<sub>rand</sub>) / (L/L<sub>rand</sub>)
                            </p>
                            <p style="margin: 8px 0; font-size: 0.9em;">
                                <strong>Criteria:</strong> σ > 1 (high clustering + short paths)
                            </p>
                            <p style="margin: 8px 0; font-size: 0.9em; color: #27ae60;">
                                <strong>Our Network:</strong> σ = 5.51  SMALL-WORLD
                            </p>
                            <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                                Where: C = clustering, L = avg path length, <sub>rand</sub> = random graph
                            </p>
                        </div>

                    </div>

                    <div style="margin-top: 25px; padding: 20px; background: #e8f4f8; border-radius: 10px; border-left: 5px solid #3498db;">
                        <h3 style="color: #2980b9; margin-bottom: 15px;"> Key Insights</h3>
                        <ul style="line-height: 1.8; font-size: 0.95em;">
                            <li><strong>κ=2 vs Resilience:</strong> Min-cut finds strategic nodes. Resilience analysis removes by degree. Different strategies!</li>
                            <li><strong>Diameter ≠ 2×Radius:</strong> Equality only in perfect symmetry (circles/spheres). Real networks are irregular.</li>
                            <li><strong>Small-World:</strong> High clustering (0.524) + short paths (8.82 hops) to σ = 5.51 > 1</li>
                            <li><strong>Modularity Q=0.792:</strong> Very strong community structure (9 geographic/modal groups)</li>
                            <li><strong>Assortativity r=0.205:</strong> Hubs connect to hubs (assortative mixing pattern)</li>
                        </ul>
                    </div>

                </div>
            </div>

            <script>
            function toggleFormulas() {
                const content = document.getElementById('formula-content');
                const toggle = document.getElementById('formula-toggle');
                if (content.style.display === 'none') {
                    content.style.display = 'block';
                    toggle.textContent = '[Click to Collapse]';
                } else {
                    content.style.display = 'none';
                    toggle.textContent = '[Click to Expand]';
                }
            }
            </script>

            <!-- Top Nodes -->
            <div class="section">
                <h2 class="section-title">Top Critical Nodes</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 25px;">

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 5px solid #3498db;">
                        <h3 style="color: #3498db; margin-bottom: 15px;">Top 5 by Degree</h3>
                        <p style="font-size: 0.9em; color: #7f8c8d; margin-bottom: 15px;">Most connected nodes</p>
                        <table>
                            <thead style="background: #3498db;">
                                <tr>
                                    <th>#</th>
                                    <th>Node</th>
                                    <th style="text-align: right;">Score</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><span class="rank-badge rank-1">1</span></td>
                                    <td><strong>SC_MMTS</strong></td>
                                    <td style="text-align: right;">0.0490</td>
                                </tr>
                                <tr>
                                    <td><span class="rank-badge rank-2">2</span></td>
                                    <td><strong>MGB_Metro</strong></td>
                                    <td style="text-align: right;">0.0460</td>
                                </tr>
                                <tr>
                                    <td><span class="rank-badge rank-3">3</span></td>
                                    <td><strong>ERA_Metro</strong></td>
                                    <td style="text-align: right;">0.0445</td>
                                </tr>
                                <tr>
                                    <td><span class="rank-badge rank-other">4</span></td>
                                    <td><strong>OMC_Metro</strong></td>
                                    <td style="text-align: right;">0.0445</td>
                                </tr>
                                <tr>
                                    <td><span class="rank-badge rank-other">5</span></td>
                                    <td><strong>SUB_Metro</strong></td>
                                    <td style="text-align: right;">0.0430</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 5px solid #e74c3c;">
                        <h3 style="color: #e74c3c; margin-bottom: 15px;">Top 5 by Betweenness</h3>
                        <p style="font-size: 0.9em; color: #7f8c8d; margin-bottom: 15px;">Critical routing bottlenecks</p>
                        <table>
                            <thead style="background: #e74c3c;">
                                <tr>
                                    <th>#</th>
                                    <th>Node</th>
                                    <th style="text-align: right;">Score</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><span class="rank-badge rank-1">1</span></td>
                                    <td><strong>HYB_MMTS</strong></td>
                                    <td style="text-align: right;">0.2560</td>
                                </tr>
                                <tr>
                                    <td><span class="rank-badge rank-2">2</span></td>
                                    <td><strong>Bus_Begumpet</strong></td>
                                    <td style="text-align: right;">0.2539</td>
                                </tr>
                                <tr>
                                    <td><span class="rank-badge rank-3">3</span></td>
                                    <td><strong>SC_MMTS</strong></td>
                                    <td style="text-align: right;">0.2385</td>
                                </tr>
                                <tr>
                                    <td><span class="rank-badge rank-other">4</span></td>
                                    <td><strong>SJVP_MMTS</strong></td>
                                    <td style="text-align: right;">0.2173</td>
                                </tr>
                                <tr>
                                    <td><span class="rank-badge rank-other">5</span></td>
                                    <td><strong>Bus_Jubilee_Hills</strong></td>
                                    <td style="text-align: right;">0.2069</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="insight-box" style="margin-top: 25px;">
                    <div class="insight-title">Centrality Differences</div>
                    <div class="insight-text">
                        <p><strong>Degree:</strong> Direct connections - metro stations with multiple lines rank high.</p>
                        <p style="margin-top: 8px;"><strong>Betweenness:</strong> Routing importance - bridge nodes connecting regions rank high.</p>
                        <p style="margin-top: 8px;"><strong>Key:</strong> HYB_MMTS tops betweenness as critical inter-regional bridge!</p>
                    </div>
                </div>
            </div>

            <!-- Insights -->
            <div class="section">
                <h2 class="section-title">Network Insights</h2>

                <div class="insight-box" style="border-left-color: #27ae60;">
                    <div class="insight-title">Small-World Network Characteristics</div>
                    <div class="insight-text">
                        <p><strong>Why Small-World:</strong></p>
                        <ul>
                            <li>High clustering: 0.524 - strong local connectivity</li>
                            <li>Short average path: 8.92 hops - efficient global reach</li>
                            <li>Small-world sigma (σ) = 5.51 - classic small-world structure</li>
                            <li>Very high modularity: 0.792 with 9 communities</li>
                        </ul>
                        <p style="margin-top: 10px;"><strong>Implication:</strong> Network combines local clustering with efficient long-distance routing - typical of well-designed urban transport!</p>
                    </div>
                </div>

                <div class="insight-box" style="border-left-color: #3498db;">
                    <div class="insight-title">Efficient Multi-Modal Integration</div>
                    <div class="insight-text">
                        <p>Small-world property enables:</p>
                        <ul>
                            <li>Average ~9 hops for any journey across 675 stations</li>
                            <li>Diameter of 22 hops (worst case is manageable)</li>
                            <li>44.5% transfer edges ensure inter-modal connectivity</li>
                            <li>High local efficiency (0.707) for neighborhood travel</li>
                        </ul>
                    </div>
                </div>

                <div class="insight-box" style="border-left-color: #27ae60;">
                    <div class="insight-title">Strength: Community Structure</div>
                    <div class="insight-text">
                        <p>Modularity 0.792 indicates:</p>
                        <ul>
                            <li>9 well-defined geographical communities</li>
                            <li>Most travel occurs within communities</li>
                            <li>Resilient to localized failures</li>
                            <li>Ideal for neighborhood-based urban planning</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- RESILIENCE ANALYSIS SECTION -->
            <div class="resilience-header" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white; padding: 2rem; border-radius: 15px; margin: 2rem 0;">
                <h2 style="margin-bottom: 15px; color: white;">Network Resilience Analysis</h2>
                <p style="font-size: 1.1em; opacity: 0.9;">
                    Systematic evaluation of network robustness through targeted node and route removal strategies
                </p>
            </div>

            <!-- METHODOLOGY SECTION -->
            <div class="methodology" style="background: #f8f9fa; padding: 2rem; border-radius: 12px; margin-bottom: 2rem;">
                <h3>Methodology: Resilience Testing Framework</h3>
                <p style="font-size: 1.05em; opacity: 0.95; margin-bottom: 10px;">
                    We employ four distinct attack strategies to comprehensively evaluate network resilience under different failure scenarios.
                </p>
                
                <div class="methodology-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
                    <div class="methodology-card" style="background: white; padding: 1.5rem; border-radius: 10px; border-left: 4px solid #3498db;">
                        <h4 style="color: #3498db;">Degree Centrality Removal</h4>
                        <p style="margin-bottom: 12px;"><strong>Target:</strong> Nodes with most connections</p>
                        <ol style="font-size: 0.9rem;">
                            <li>Calculate degree centrality for all nodes</li>
                            <li>Rank nodes by number of direct connections</li>
                            <li>Remove highest-degree node</li>
                            <li>Recalculate network metrics</li>
                            <li>Repeat until significant degradation</li>
                        </ol>
                        <p style="margin-top: 12px; font-style: italic; color: #666;">Simulates: Hub station failures</p>
                    </div>

                    <div class="methodology-card" style="background: white; padding: 1.5rem; border-radius: 10px; border-left: 4px solid #e74c3c;">
                        <h4 style="color: #e74c3c;">Betweenness Centrality Removal</h4>
                        <p style="margin-bottom: 12px;"><strong>Target:</strong> Critical routing bottlenecks</p>
                        <ol style="font-size: 0.9rem;">
                            <li>Calculate betweenness centrality (shortest paths through node)</li>
                            <li>Identify nodes critical for inter-regional travel</li>
                            <li>Remove highest-betweenness node</li>
                            <li>Measure routing efficiency impact</li>
                            <li>Iterate through ranked list</li>
                        </ol>
                        <p style="margin-top: 12px; font-style: italic; color: #666;">Simulates: Transfer point disruptions</p>
                    </div>

                    <div class="methodology-card" style="background: white; padding: 1.5rem; border-radius: 10px; border-left: 4px solid #9b59b6;">
                        <h4 style="color: #9b59b6;">Closeness Centrality Removal</h4>
                        <p style="margin-bottom: 12px;"><strong>Target:</strong> Most centrally located nodes</p>
                        <ol style="font-size: 0.9rem;">
                            <li>Calculate closeness centrality (avg distance to all nodes)</li>
                            <li>Find nodes with shortest paths to network</li>
                            <li>Remove most central node</li>
                            <li>Track path length increases</li>
                            <li>Continue sequential removal</li>
                        </ol>
                        <p style="margin-top: 12px; font-style: italic; color: #666;">Simulates: Central district shutdowns</p>
                    </div>

                    <div class="methodology-card" style="background: white; padding: 1.5rem; border-radius: 10px; border-left: 4px solid #f39c12;">
                        <h4 style="color: #f39c12;">Route Removal</h4>
                        <p style="margin-bottom: 12px;"><strong>Target:</strong> Major transit routes (Metro/MMTS/Bus)</p>
                        <ol style="font-size: 0.9rem;">
                            <li>Calculate edge betweenness for all routes</li>
                            <li>Rank routes by importance and ridership</li>
                            <li>Remove entire route (edge)</li>
                            <li>Assess alternative path availability</li>
                            <li>Repeat for critical routes</li>
                        </ol>
                        <p style="margin-top: 12px; font-style: italic; color: #666;">Simulates: Line closures/service disruptions</p>
                    </div>
                </div>

                <div style="background: rgba(255,255,255,0.95); color: #333; padding: 20px; border-radius: 10px; margin-top: 25px; border: 2px solid #3498db;">
                    <h4 style="color: #e74c3c; margin-bottom: 12px;">Metrics Tracked at Each Step:</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; font-size: 0.95em;">
                        <div>• Network Efficiency</div>
                        <div>• Number of Components</div>
                        <div>• Largest Component Size</div>
                        <div>• Average Clustering</div>
                        <div>• Average Betweenness</div>
                        <div>• Average Closeness</div>
                        <div>• Average Degree</div>
                        <div>• Average Travel Time</div>
                        <div>• Average Cost</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title" style="color: #3498db;">Degree Centrality Removal</h2>
                <div class="insight-box" style="border-left-color: #3498db;">
                    <div class="insight-title">Analysis Overview</div>
                    <div class="insight-text">
                        <p>Removes nodes with highest degree (most connections) one by one</p>
                        <p style="margin-top: 10px;"><strong>Network Info:</strong> 675 nodes, 3434 edges</p>
                        <p><strong>Analysis Date:</strong> 2025-11-13</p>
                    </div>
                </div>

                <h3 style="margin: 30px 0 20px 0; color: #2c3e50;">Combined View (All Metrics)</h3>
                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 15px; text-align: center;">
                    <p style="margin: 0; color: #1976d2; font-size: 0.95rem;">Click image below to open full-size dashboard with all metrics combined</p>
                </div>
                <img src="degree_removal/combined_dashboard.png" style="width: 100%; max-width: 1200px; display: block; margin: 0 auto; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); cursor: pointer;" alt="Degree Centrality Removal Dashboard" onclick="window.open('degree_removal/combined_dashboard.png', '_blank')">

                <h3 style="margin: 30px 0 20px 0; color: #2c3e50;">Top 15 Nodes Removed (Sequential Order)</h3>
                <table style="margin: 0 auto; max-width: 900px; width: 100%;">
                    <thead style="background: #3498db;">
                        <tr>
                            <th>Rank</th>
                            <th>Node ID</th>
                            <th>Name</th>
                            <th>Layer</th>
                            <th>Score</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1</td><td><strong>SC_MMTS</strong></td><td>SECUNDERABAD</td><td>mmts</td><td>0.0490</td></tr>
                        <tr><td>2</td><td><strong>MGB_Metro</strong></td><td>Mahatma Gandhi Bus Station</td><td>metro</td><td>0.0460</td></tr>
                        <tr><td>3</td><td><strong>ERA_Metro</strong></td><td>Erragadda</td><td>metro</td><td>0.0445</td></tr>
                        <tr><td>4</td><td><strong>OMC_Metro</strong></td><td>Osmania Medical College</td><td>metro</td><td>0.0445</td></tr>
                        <tr><td>5</td><td><strong>SUB_Metro</strong></td><td>Sultan Bazar</td><td>metro</td><td>0.0430</td></tr>
                        <tr><td>6</td><td><strong>BTN_Metro</strong></td><td>Bharat Nagar</td><td>metro</td><td>0.0415</td></tr>
                        <tr><td>7</td><td><strong>BTNR_MMTS</strong></td><td>BHARATNAGAR</td><td>mmts</td><td>0.0415</td></tr>
                        <tr><td>8</td><td><strong>AME_Metro</strong></td><td>Ameerpet</td><td>metro</td><td>0.0401</td></tr>
                        <tr><td>9</td><td><strong>SCR_Metro</strong></td><td>Secunderabad West</td><td>metro</td><td>0.0386</td></tr>
                        <tr><td>10</td><td><strong>ESI_Metro</strong></td><td>ESI Hospital</td><td>metro</td><td>0.0371</td></tr>
                        <tr><td>11</td><td><strong>ASM_Metro</strong></td><td>Assembly</td><td>metro</td><td>0.0356</td></tr>
                        <tr><td>12</td><td><strong>GNH_Metro</strong></td><td>Gandhi Hospital</td><td>metro</td><td>0.0356</td></tr>
                        <tr><td>13</td><td><strong>MSP_Metro</strong></td><td>Moosapet</td><td>metro</td><td>0.0341</td></tr>
                        <tr><td>14</td><td><strong>SRN_Metro</strong></td><td>S. R. Nagar</td><td>metro</td><td>0.0341</td></tr>
                        <tr><td>15</td><td><strong>GAB_Metro</strong></td><td>Gandhi Bhavan</td><td>metro</td><td>0.0341</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" style="margin-top: 3rem;">
                <h2 class="section-title" style="color: #e74c3c;">Betweenness Centrality Removal</h2>
                <div class="insight-box" style="border-left-color: #e74c3c;">
                    <div class="insight-title">Analysis Overview</div>
                    <div class="insight-text">
                        <p>Removes nodes with highest betweenness (critical routing bottlenecks) one by one</p>
                        <p style="margin-top: 10px;"><strong>Network Info:</strong> 675 nodes, 3434 edges</p>
                        <p><strong>Analysis Date:</strong> 2025-11-13</p>
                    </div>
                </div>

                <h3 style="margin: 30px 0 20px 0; color: #2c3e50;">Combined View (All Metrics)</h3>
                <div style="background: #ffebee; padding: 15px; border-radius: 8px; margin-bottom: 15px; text-align: center;">
                    <p style="margin: 0; color: #c62828; font-size: 0.95rem;">Click image below to open full-size dashboard with all metrics combined</p>
                </div>
                <img src="betweenness_removal/combined_dashboard.png" style="width: 100%; max-width: 1200px; display: block; margin: 0 auto; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); cursor: pointer;" alt="Betweenness Centrality Removal Dashboard" onclick="window.open('betweenness_removal/combined_dashboard.png', '_blank')">

                <h3 style="margin: 30px 0 20px 0; color: #2c3e50;">Top 15 Nodes Removed (Sequential Order)</h3>
                <table style="margin: 0 auto; max-width: 900px; width: 100%;">
                    <thead style="background: #e74c3c;">
                        <tr>
                            <th>Rank</th>
                            <th>Node ID</th>
                            <th>Name</th>
                            <th>Layer</th>
                            <th>Score</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1</td><td><strong>HYB_MMTS</strong></td><td>HYDERABAD</td><td>mmts</td><td>0.2560</td></tr>
                        <tr><td>2</td><td><strong>Bus_Begumpet</strong></td><td>Begumpet Bus Hub</td><td>bus</td><td>0.2539</td></tr>
                        <tr><td>3</td><td><strong>SC_MMTS</strong></td><td>SECUNDERABAD</td><td>mmts</td><td>0.2385</td></tr>
                        <tr><td>4</td><td><strong>SJVP_MMTS</strong></td><td>SANJEEVAIAH PARK</td><td>mmts</td><td>0.2173</td></tr>
                        <tr><td>5</td><td><strong>Bus_Jubilee_Hills</strong></td><td>Jubilee Hills Bus Hub</td><td>bus</td><td>0.2069</td></tr>
                        <tr><td>6</td><td><strong>Bus_feeder_AME_Metro_1</strong></td><td>Bus near Ameerpet</td><td>bus</td><td>0.2065</td></tr>
                        <tr><td>7</td><td><strong>KCG_MMTS</strong></td><td>KACHEGUDA</td><td>mmts</td><td>0.1956</td></tr>
                        <tr><td>8</td><td><strong>Bus_feeder_AME_Metro_3</strong></td><td>Bus near Ameerpet</td><td>bus</td><td>0.1794</td></tr>
                        <tr><td>9</td><td><strong>BMT_MMTS</strong></td><td>BEGUMPET</td><td>mmts</td><td>0.1642</td></tr>
                        <tr><td>10</td><td><strong>MXT_MMTS</strong></td><td>MALAKPET</td><td>mmts</td><td>0.1603</td></tr>
                        <tr><td>11</td><td><strong>MSB_Metro</strong></td><td>Musarambagh</td><td>metro</td><td>0.1283</td></tr>
                        <tr><td>12</td><td><strong>DSN_Metro</strong></td><td>Dilsukh Nagar</td><td>metro</td><td>0.1241</td></tr>
                        <tr><td>13</td><td><strong>Bus_Musheerabad</strong></td><td>Musheerabad Bus Hub</td><td>bus</td><td>0.1067</td></tr>
                        <tr><td>14</td><td><strong>LGDH_MMTS</strong></td><td>LALAGUDA GATE</td><td>mmts</td><td>0.1017</td></tr>
                        <tr><td>15</td><td><strong>BTNR_MMTS</strong></td><td>BHARATNAGAR</td><td>mmts</td><td>0.1001</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" style="margin-top: 3rem;">
                <h2 class="section-title" style="color: #9b59b6;">Closeness Centrality Removal</h2>
                <div class="insight-box" style="border-left-color: #9b59b6;">
                    <div class="insight-title">Analysis Overview</div>
                    <div class="insight-text">
                        <p>Removes nodes with highest closeness (most centrally located) one by one</p>
                        <p style="margin-top: 10px;"><strong>Network Info:</strong> 675 nodes, 3434 edges</p>
                        <p><strong>Analysis Date:</strong> 2025-11-13</p>
                    </div>
                </div>

                <h3 style="margin: 30px 0 20px 0; color: #2c3e50;">Combined View (All Metrics)</h3>
                <div style="background: #f3e5f5; padding: 15px; border-radius: 8px; margin-bottom: 15px; text-align: center;">
                    <p style="margin: 0; color: #7b1fa2; font-size: 0.95rem;">Click image below to open full-size dashboard with all metrics combined</p>
                </div>
                <img src="closeness_removal/combined_dashboard.png" style="width: 100%; max-width: 1200px; display: block; margin: 0 auto; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); cursor: pointer;" alt="Closeness Centrality Removal Dashboard" onclick="window.open('closeness_removal/combined_dashboard.png', '_blank')">

                <h3 style="margin: 30px 0 20px 0; color: #2c3e50;">Top 15 Nodes Removed (Sequential Order)</h3>
                <table style="margin: 0 auto; max-width: 900px; width: 100%;">
                    <thead style="background: #9b59b6;">
                        <tr>
                            <th>Rank</th>
                            <th>Node ID</th>
                            <th>Name</th>
                            <th>Layer</th>
                            <th>Score</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1</td><td><strong>SJVP_MMTS</strong></td><td>SANJEEVAIAH PARK</td><td>mmts</td><td>0.1728</td></tr>
                        <tr><td>2</td><td><strong>Bus_Begumpet</strong></td><td>Begumpet Bus Hub</td><td>bus</td><td>0.1715</td></tr>
                        <tr><td>3</td><td><strong>BMT_MMTS</strong></td><td>BEGUMPET</td><td>mmts</td><td>0.1672</td></tr>
                        <tr><td>4</td><td><strong>SC_MMTS</strong></td><td>SECUNDERABAD</td><td>mmts</td><td>0.1645</td></tr>
                        <tr><td>5</td><td><strong>JET_MMTS</strong></td><td>JAMES STREET</td><td>mmts</td><td>0.1637</td></tr>
                        <tr><td>6</td><td><strong>HYB_MMTS</strong></td><td>HYDERABAD</td><td>mmts</td><td>0.1636</td></tr>
                        <tr><td>7</td><td><strong>Bus_Musheerabad</strong></td><td>Musheerabad Bus Hub</td><td>bus</td><td>0.1631</td></tr>
                        <tr><td>8</td><td><strong>LKPL_MMTS</strong></td><td>LAKDIKAPUL</td><td>mmts</td><td>0.1616</td></tr>
                        <tr><td>9</td><td><strong>Bus_feeder_AME_Metro_1</strong></td><td>Bus near Ameerpet</td><td>bus</td><td>0.1613</td></tr>
                        <tr><td>10</td><td><strong>Bus_feeder_SCR_Metro_3</strong></td><td>Bus near Secunderabad West</td><td>bus</td><td>0.1594</td></tr>
                        <tr><td>11</td><td><strong>Auto_R3_16</strong></td><td>Auto Stand R3-16</td><td>auto</td><td>0.1588</td></tr>
                        <tr><td>12</td><td><strong>Bus_feeder_GNH_Metro_3</strong></td><td>Bus near Gandhi Hospital</td><td>bus</td><td>0.1584</td></tr>
                        <tr><td>13</td><td><strong>Auto_R3_56</strong></td><td>Auto Stand R3-56</td><td>auto</td><td>0.1584</td></tr>
                        <tr><td>14</td><td><strong>Bus_Panjagutta</strong></td><td>Panjagutta Bus Hub</td><td>bus</td><td>0.1574</td></tr>
                        <tr><td>15</td><td><strong>Bus_feeder_PUN_Metro_0</strong></td><td>Bus near Panjagutta</td><td>bus</td><td>0.1571</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="section" style="margin-top: 3rem;">
                <h2 class="section-title" style="color: #f39c12;">Route Removal</h2>
                <div class="insight-box" style="border-left-color: #f39c12;">
                    <div class="insight-title">Analysis Overview</div>
                    <div class="insight-text">
                        <p>Removes major transit routes (Metro lines, MMTS, Bus routes) one by one</p>
                        <p style="margin-top: 10px;"><strong>Network Info:</strong> 675 nodes, 3434 edges</p>
                        <p><strong>Analysis Date:</strong> 2025-11-13</p>
                    </div>
                </div>

                <h3 style="margin: 30px 0 20px 0; color: #2c3e50;">Combined View (All Metrics)</h3>
                <div style="background: #fff3e0; padding: 15px; border-radius: 8px; margin-bottom: 15px; text-align: center;">
                    <p style="margin: 0; color: #e65100; font-size: 0.95rem;">Click image below to open full-size dashboard with all metrics combined</p>
                </div>
                <img src="route_removal/combined_dashboard.png" style="width: 100%; max-width: 1200px; display: block; margin: 0 auto; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); cursor: pointer;" alt="Route Removal Dashboard" onclick="window.open('route_removal/combined_dashboard.png', '_blank')">

                <h3 style="margin: 30px 0 20px 0; color: #2c3e50;">Top 15 Routes Removed (Sequential Order)</h3>
                <table style="margin: 0 auto; max-width: 1200px; width: 100%;">
                    <thead style="background: #f39c12;">
                        <tr>
                            <th>Rank</th>
                            <th>From to To</th>
                            <th>Route Name</th>
                            <th>Mode</th>
                            <th>Distance (km)</th>
                            <th>Time (min)</th>
                            <th>Score</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td><strong>1</strong></td><td><strong>BMT_MMTS</strong> to <strong>SC_MMTS</strong></td><td>BEGUMPET - SECUNDERABAD</td><td style="text-transform: uppercase;">mmts</td><td>4.64</td><td>15.34</td><td>0.2784</td></tr>
                        <tr><td><strong>2</strong></td><td><strong>OMC_Metro</strong> to <strong>MGB_Metro</strong></td><td>Osmania Medical College - Mahatma Gandhi Bus Station</td><td style="text-transform: uppercase;">metro</td><td>0.54</td><td>4.15</td><td>0.2778</td></tr>
                        <tr><td><strong>3</strong></td><td><strong>MGB_Metro</strong> to <strong>SUB_Metro</strong></td><td>Mahatma Gandhi Bus Station - Sultan Bazar</td><td style="text-transform: uppercase;">metro</td><td>0.57</td><td>4.22</td><td>0.2733</td></tr>
                        <tr><td><strong>4</strong></td><td><strong>HYB_MMTS</strong> to <strong>SJVP_MMTS</strong></td><td>HYDERABAD - SANJEEVAIAH PARK</td><td style="text-transform: uppercase;">mmts</td><td>4.90</td><td>16.63</td><td>0.2713</td></tr>
                        <tr><td><strong>5</strong></td><td><strong>BTN_Metro</strong> to <strong>ERA_Metro</strong></td><td>Bharat Nagar - Erragadda</td><td style="text-transform: uppercase;">metro</td><td>0.73</td><td>3.81</td><td>0.2674</td></tr>
                        <tr><td><strong>6</strong></td><td><strong>SC_MMTS</strong> to <strong>LGDH_MMTS</strong></td><td>SECUNDERABAD - LALAGUDA GATE</td><td style="text-transform: uppercase;">mmts</td><td>2.59</td><td>10.63</td><td>0.2632</td></tr>
                        <tr><td><strong>7</strong></td><td><strong>ERA_Metro</strong> to <strong>ESI_Metro</strong></td><td>Erragadda - ESI Hospital</td><td style="text-transform: uppercase;">metro</td><td>1.02</td><td>4.61</td><td>0.2606</td></tr>
                        <tr><td><strong>8</strong></td><td><strong>HYB_MMTS</strong> to <strong>KCG_MMTS</strong></td><td>HYDERABAD - KACHEGUDA</td><td style="text-transform: uppercase;">mmts</td><td>3.44</td><td>13.82</td><td>0.2547</td></tr>
                        <tr><td><strong>9</strong></td><td><strong>GAB_Metro</strong> to <strong>OMC_Metro</strong></td><td>Gandhi Bhavan - Osmania Medical College</td><td style="text-transform: uppercase;">metro</td><td>0.98</td><td>5.27</td><td>0.2498</td></tr>
                        <tr><td><strong>10</strong></td><td><strong>SC_MMTS</strong> to <strong>Bus_Paradise</strong></td><td>SECUNDERABAD - Paradise Bus Hub</td><td style="text-transform: uppercase;">transfer</td><td>0.55</td><td>8.53</td><td>0.2436</td></tr>
                        <tr><td><strong>11</strong></td><td><strong>Bus_Begumpet</strong> to <strong>Bus_feeder_AME_Metro_1</strong></td><td>Begumpet Bus Hub - Bus near Ameerpet</td><td style="text-transform: uppercase;">bus</td><td>2.17</td><td>10.23</td><td>0.2428</td></tr>
                        <tr><td><strong>12</strong></td><td><strong>MSP_Metro</strong> to <strong>BTN_Metro</strong></td><td>Moosapet - Bharat Nagar</td><td style="text-transform: uppercase;">metro</td><td>1.10</td><td>4.38</td><td>0.2371</td></tr>
                        <tr><td><strong>13</strong></td><td><strong>SRN_Metro</strong> to <strong>AME_Metro</strong></td><td>S. R. Nagar - Ameerpet</td><td style="text-transform: uppercase;">metro</td><td>0.93</td><td>4.41</td><td>0.2370</td></tr>
                        <tr><td><strong>14</strong></td><td><strong>Bus_feeder_AME_Metro_1</strong> to <strong>Bus_feeder_AME_Metro_3</strong></td><td>Bus near Ameerpet - Bus near Ameerpet</td><td style="text-transform: uppercase;">bus</td><td>0.64</td><td>4.69</td><td>0.2323</td></tr>
                        <tr><td><strong>15</strong></td><td><strong>Bus_Jubilee_Hills</strong> to <strong>Bus_feeder_AME_Metro_3</strong></td><td>Jubilee Hills Bus Hub - Bus near Ameerpet</td><td style="text-transform: uppercase;">bus</td><td>3.64</td><td>15.52</td><td>0.2312</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- COMBINED EFFICIENCY LOSS CURVE -->
            <div class="section" style="margin-top: 3rem;">
                <h2 class="section-title" style="color: #c0392b;">Combined Efficiency Loss Comparison</h2>
                <div class="insight-box" style="border-left-color: #c0392b;">
                    <div class="insight-title">Comparative Analysis: All Removal Strategies</div>
                    <div class="insight-text">
                        <p>This graph compares how network efficiency degrades across all four removal strategies. 
                        The steeper the decline, the more vulnerable the network is to that type of attack.</p>
                        <p style="margin-top: 10px;"><strong>Key Insights:</strong></p>
                        <ul>
                            <li>Identifies which attack strategy causes fastest efficiency loss</li>
                            <li>Shows relative network robustness against different failure modes</li>
                            <li>Helps prioritize infrastructure improvements</li>
                        </ul>
                    </div>
                </div>

                <h3 style="margin: 30px 0 20px 0; color: #2c3e50;">Network Efficiency vs. Removals</h3>
                <img src="efficiency_comparison.png" style="width: 100%; max-width: 1200px; display: block; margin: 0 auto; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); cursor: pointer;" alt="Combined Efficiency Loss" onclick="window.open('combined_efficiency_loss.png', '_blank')">
                
                <div class="insight-box" style="border-left-color: #27ae60; margin-top: 25px;">
                    <div class="insight-title">Interpretation Guide</div>
                    <div class="insight-text">
                        <p><strong>Steeper curves indicate:</strong> Higher vulnerability to that removal strategy</p>
                        <p style="margin-top: 8px;"><strong>Flatter curves indicate:</strong> Better resilience and redundancy</p>
                        <p style="margin-top: 8px;"><strong>Early divergence:</strong> Network has critical single points of failure</p>
                        <p style="margin-top: 8px;"><strong>Late divergence:</strong> Well-distributed load across network</p>
                    </div>
                </div>

        </div> <!-- End analytics-tab -->

    <div class="footer">
        <p><strong>Hyderabad Urban Mobility & Public Transport Networks</strong></p>
        <p>Data: GTFS (Metro & MMTS - Validated & Cleaned) | Analysis Date: November 2025</p>
        <p>Network: 675 nodes (57 Metro, 46 MMTS, 200 Bus, 372 Auto) | 6,269 edges (48.7% inter-modal transfers)</p>
        <p>Features: 3 Metro lines, 5 MMTS corridors, 7 regions | Zero isolated nodes | Complex Network Metrics</p>
    </div>

    <script>
        // Global data
        let nodesData = [];
        let edgesData = [];
        let network = null;
        let visibleLayers = new Set(['metro', 'mmts', 'bus', 'auto']);
        let currentSampleSize = 100;

        const layerColors = {
            'metro': '#764ba2',
            'mmts': '#fa709a',
            'bus': '#f093fb',
            'auto': '#4facfe'
        };

        // Tab switching
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');

            // Load map if switching to map tab
            if (tabName === 'map' && !network) {
                console.log(' Loading network map data...');
                loadData();
            }
        }

        // Load CSV data
        async function loadData() {
            try {
                console.log(' Fetching nodes.csv...');
                // Load nodes (with cache-busting timestamp)
                const nodesResp = await fetch('nodes.csv?t=' + new Date().getTime());
                const nodesText = await nodesResp.text();
                const nodesLines = nodesText.split('\n');
                console.log(` Loaded ${nodesLines.length} node lines`);
                
                for (let i = 1; i < nodesLines.length; i++) {
                    if (!nodesLines[i].trim()) continue;
                    const vals = nodesLines[i].split(',');
                    nodesData.push({
                        id: vals[0],
                        name: vals[1],
                        lat: parseFloat(vals[2]),
                        lon: parseFloat(vals[3]),
                        layer: vals[4],
                        region: vals[6]
                    });
                }

                // Load edges (with cache-busting timestamp)
                const edgesResp = await fetch('edges.csv?t=' + new Date().getTime());
                const edgesText = await edgesResp.text();
                const edgesLines = edgesText.split('\n');
                
                for (let i = 1; i < edgesLines.length; i++) {
                    if (!edgesLines[i].trim()) continue;
                    const vals = edgesLines[i].split(',');
                    edgesData.push({
                        from: vals[0],
                        to: vals[1],
                        mode: vals[2],
                        type: vals[3],
                        distance: parseFloat(vals[5]),
                        time: parseFloat(vals[7])
                    });
                }

                // Update stats
                document.getElementById('total-edges').textContent = edgesData.length.toLocaleString();
                const autoCount = nodesData.filter(n => n.layer === 'auto').length;
                document.getElementById('auto-count').textContent = autoCount;

                renderNetwork();
                calculateTransferBreakdown();
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        function renderNetwork() {
            console.log(' Rendering network map...');
            console.log(`  Total nodes loaded: ${nodesData.length}`);
            console.log(`  Total edges loaded: ${edgesData.length}`);
            console.log(`  Sample size: ${currentSampleSize}`);
            console.log(`  Visible layers: ${Array.from(visibleLayers).join(', ')}`);
            
            let sampledNodes = [];
            if (currentSampleSize === 'all') {
                sampledNodes = nodesData;
            } else {
                const sampleSize = parseInt(currentSampleSize);
                const layers = ['metro', 'mmts', 'bus', 'auto'];
                const layerCounts = {
                    'metro': 57, 'mmts': 46, 'bus': 200, 'auto': 372
                };
                
                layers.forEach(layer => {
                    const layerNodes = nodesData.filter(n => n.layer === layer);
                    const proportion = layerCounts[layer] / 675;
                    const sampleCount = Math.round(sampleSize * proportion);
                    const step = Math.floor(layerNodes.length / sampleCount) || 1;
                    
                    for (let i = 0; i < layerNodes.length && sampledNodes.length < sampleSize; i += step) {
                        sampledNodes.push(layerNodes[i]);
                    }
                });
            }

            const visibleNodes = sampledNodes.filter(n => visibleLayers.has(n.layer));
            const nodeIds = new Set(visibleNodes.map(n => n.id));

            const nodes = visibleNodes.map(node => ({
                id: node.id,
                label: node.name.length > 20 ? node.name.substring(0, 17) + '...' : node.name,
                title: `${node.name}<br>Layer: ${node.layer}<br>Region: ${node.region}`,
                color: layerColors[node.layer],
                x: (node.lon - 78.4) * 10000,
                y: (17.5 - node.lat) * 10000,
                shape: 'dot',
                size: node.layer === 'metro' || node.layer === 'mmts' ? 15 : 8
            }));

            const edgeFilter = document.getElementById('edge-filter').value;
            let filteredEdges = edgesData.filter(e => nodeIds.has(e.from) && nodeIds.has(e.to));

            if (edgeFilter === 'transfer') {
                filteredEdges = filteredEdges.filter(e => e.type === 'inter');
            } else if (edgeFilter === 'intra') {
                filteredEdges = filteredEdges.filter(e => e.type === 'intra');
            } else if (edgeFilter !== 'all') {
                filteredEdges = filteredEdges.filter(e => e.mode === edgeFilter);
            }

            const edges = filteredEdges.map(edge => ({
                from: edge.from,
                to: edge.to,
                color: edge.type === 'inter' ? '#667eea' : '#333333',
                width: edge.type === 'inter' ? 2 : 1,
                dashes: edge.type === 'inter',
                title: `${edge.mode} (${edge.distance.toFixed(1)} km, ${edge.time.toFixed(0)} min)`
            }));

            const container = document.getElementById('network-map');
            if (!container) {
                console.error(' Network map container not found!');
                return;
            }
            
            const data = { nodes: nodes, edges: edges };
            console.log(`  Rendering ${nodes.length} nodes and ${edges.length} edges`);
            
            const options = {
                nodes: {
                    font: { size: 10, color: '#333' },
                    borderWidth: 2
                },
                edges: {
                    arrows: { to: { enabled: false } },
                    smooth: { enabled: true, type: 'continuous' }
                },
                physics: { enabled: false },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    zoomView: true,
                    dragView: true
                }
            };

            if (network) network.destroy();
            network = new vis.Network(container, data, options);
            console.log(' Network map rendered successfully!');
        }

        function toggleLayer(layer) {
            if (visibleLayers.has(layer)) {
                visibleLayers.delete(layer);
                event.target.classList.remove('active');
            } else {
                visibleLayers.add(layer);
                event.target.classList.add('active');
            }
            renderNetwork();
        }

        function filterEdges() {
            renderNetwork();
        }

        function changeSampleSize() {
            currentSampleSize = document.getElementById('sample-size').value;
            renderNetwork();
        }

        function calculateTransferBreakdown() {
            const transfers = {
                'auto_metro': 0, 'bus_metro': 0, 'auto_mmts': 0,
                'bus_mmts': 0, 'auto_bus': 0
            };

            let totalTransfers = 0;
            edgesData.forEach(edge => {
                if (edge.type === 'inter') {
                    totalTransfers++;
                    const from_layer = nodesData.find(n => n.id === edge.from)?.layer;
                    const to_layer = nodesData.find(n => n.id === edge.to)?.layer;
                    
                    if (from_layer && to_layer) {
                        const key = [from_layer, to_layer].sort().join('_');
                        if (transfers[key] !== undefined) transfers[key]++;
                    }
                }
            });

            console.log('Transfer breakdown:', transfers);
            console.log('Total transfers:', totalTransfers);

            // Update stats text
            const pct = Math.round(totalTransfers * 100 / edgesData.length);
            const statsEl = document.getElementById('transfer-stats');
            if (statsEl) {
                statsEl.textContent = `${totalTransfers.toLocaleString()} out of ${edgesData.length.toLocaleString()} edges (${pct}%)`;
            }

            const html = `
                <div class="transfer-card">
                    <h4> to  Metro to Bus</h4>
                    <div class="transfer-count">${transfers.bus_metro || 0}</div>
                    <p>Walk from Metro station to nearby bus stop</p>
                </div>
                <div class="transfer-card">
                    <h4> to  Metro to Auto</h4>
                    <div class="transfer-count">${transfers.auto_metro || 0}</div>
                    <p>Exit Metro and take auto from stand</p>
                </div>
                <div class="transfer-card">
                    <h4> to  MMTS to Bus</h4>
                    <div class="transfer-count">${transfers.bus_mmts || 0}</div>
                    <p>Walk from MMTS station to bus stop</p>
                </div>
                <div class="transfer-card">
                    <h4> to  MMTS to Auto</h4>
                    <div class="transfer-count">${transfers.auto_mmts || 0}</div>
                    <p>MMTS station to auto stand</p>
                </div>
                <div class="transfer-card">
                    <h4> to  Bus to Auto</h4>
                    <div class="transfer-count">${transfers.auto_bus || 0}</div>
                    <p>Bus stop to nearby auto stand</p>
                </div>
            `;
            
            document.getElementById('transfer-breakdown').innerHTML = html;
        }

        // Load and render analytics
        async function loadAnalytics() {
            try {
                console.log(' Loading analytics data...');
                const response = await fetch('analysis_data.json?t=' + new Date().getTime());
                const analysis = await response.json();
                console.log(' Analytics data loaded successfully');
                
                // 1. Connectivity Chart
                const connectivity = analysis.connectivity;
                Plotly.newPlot('connectivity-chart', [
                    {
                        x: ['Metro', 'MMTS', 'Bus', 'Auto'],
                        y: [connectivity.metro.min, connectivity.mmts.min, connectivity.bus.min, connectivity.auto.min],
                        name: 'Minimum',
                        type: 'bar',
                        marker: { color: '#f093fb' }
                    },
                    {
                        x: ['Metro', 'MMTS', 'Bus', 'Auto'],
                        y: [connectivity.metro.avg, connectivity.mmts.avg, connectivity.bus.avg, connectivity.auto.avg],
                        name: 'Average',
                        type: 'bar',
                        marker: { color: '#667eea' }
                    },
                    {
                        x: ['Metro', 'MMTS', 'Bus', 'Auto'],
                        y: [connectivity.metro.max, connectivity.mmts.max, connectivity.bus.max, connectivity.auto.max],
                        name: 'Maximum',
                        type: 'bar',
                        marker: { color: '#4facfe' }
                    }
                ], {
                    title: 'Edges per Node by Layer',
                    yaxis: { title: 'Number of Edges' },
                    barmode: 'group'
                }, {responsive: true});

                // 2. Regional Distribution
                const regional = analysis.regional_distribution;
                const regionNames = {
                    'R1': 'Secunderabad/North',
                    'R2': 'Old City/South', 
                    'R3': 'Deccan/South-Central',
                    'R4': 'HITEC City/West',
                    'R5': 'Kukatpally/NW',
                    'R6': 'Uppal/East',
                    'R7': 'LB Nagar/Periphery'
                };
                
                Plotly.newPlot('regional-chart', [
                    {
                        x: Object.keys(regional),
                        y: Object.values(regional).map(r => r.metro),
                        name: 'Metro',
                        type: 'bar',
                        marker: { color: '#764ba2' }
                    },
                    {
                        x: Object.keys(regional),
                        y: Object.values(regional).map(r => r.mmts),
                        name: 'MMTS',
                        type: 'bar',
                        marker: { color: '#fa709a' }
                    },
                    {
                        x: Object.keys(regional),
                        y: Object.values(regional).map(r => r.bus),
                        name: 'Bus',
                        type: 'bar',
                        marker: { color: '#f093fb' }
                    },
                    {
                        x: Object.keys(regional),
                        y: Object.values(regional).map(r => r.auto),
                        name: 'Auto',
                        type: 'bar',
                        marker: { color: '#4facfe' }
                    }
                ], {
                    title: 'Transport Nodes by Region',
                    xaxis: { 
                        ticktext: Object.keys(regional).map(r => `${r}<br>${regionNames[r]}`),
                        tickvals: Object.keys(regional)
                    },
                    yaxis: { title: 'Number of Nodes' },
                    barmode: 'stack'
                }, {responsive: true});

                // 3. Metro Lines - Stations
                const metro = analysis.metro_lines;
                Plotly.newPlot('metro-stations-chart', [{
                    labels: ['Red Line', 'Blue Line', 'Green Line'],
                    values: [metro.Red.stations, metro.Blue.stations, metro.Green.stations],
                    type: 'pie',
                    marker: {
                        colors: ['#E31E24', '#007ABB', '#009846']
                    },
                    textinfo: 'label+value',
                    hole: 0.4
                }], {
                    title: 'Metro Stations by Line',
                    annotations: [{
                        text: `${analysis.basic.nodes_by_layer.metro}<br>Total`,
                        x: 0.5, y: 0.5,
                        font: { size: 16 },
                        showarrow: false
                    }]
                }, {responsive: true});

                // 4. Metro Lines - Length
                Plotly.newPlot('metro-length-chart', [{
                    x: ['Red', 'Blue', 'Green'],
                    y: [metro.Red.length_km, metro.Blue.length_km, metro.Green.length_km],
                    type: 'bar',
                    marker: {
                        color: ['#E31E24', '#007ABB', '#009846']
                    },
                    text: [metro.Red.length_km, metro.Blue.length_km, metro.Green.length_km],
                    textposition: 'outside',
                    texttemplate: '%{text} km'
                }], {
                    title: 'Metro Line Length (km)',
                    yaxis: { title: 'Length (km)' }
                }, {responsive: true});

                // 5. Interchange Stations
                const interchangeHtml = metro.interchanges.stations.map(s => {
                    const lines = s.metro_line.split('+').map(line => {
                        const colors = { 'Red': '#E31E24', 'Blue': '#007ABB', 'Green': '#009846' };
                        return `<span style="color: ${colors[line]}; font-weight: bold;">${line}</span>`;
                    }).join(' + ');
                    return `<div style="padding: 0.5rem; margin: 0.3rem 0; background: #f5f5f5; border-radius: 4px;">
                        <strong>${s.name}</strong> - ${lines}
                    </div>`;
                }).join('');
                document.getElementById('interchange-list').innerHTML = interchangeHtml;

                // 6. Distance Analysis
                const distances = analysis.distances;
                Plotly.newPlot('distance-chart', [{
                    x: ['Metro', 'MMTS', 'Bus', 'Auto'],
                    y: [distances.metro.avg, distances.mmts.avg, distances.bus.avg, distances.auto.avg],
                    type: 'bar',
                    marker: {
                        color: ['#764ba2', '#fa709a', '#f093fb', '#4facfe']
                    },
                    text: [distances.metro.avg, distances.mmts.avg, distances.bus.avg, distances.auto.avg],
                    textposition: 'outside',
                    texttemplate: '%{text} km'
                }], {
                    title: 'Average Edge Distance by Mode',
                    yaxis: { title: 'Distance (km)' }
                }, {responsive: true});

                // 7. Travel Time Analysis (using actual data from edges)
                const travelTimes = analysis.travel_times || {};
                if (travelTimes.metro && travelTimes.mmts && travelTimes.bus && travelTimes.auto) {
                    Plotly.newPlot('travel-time-chart', [{
                        x: ['Transfer', 'Metro', 'Bus', 'Auto', 'MMTS'],
                        y: [analysis.transfers.avg_time, 
                            travelTimes.metro.avg, 
                            travelTimes.bus.avg,
                            travelTimes.auto.avg,
                            travelTimes.mmts.avg],
                        type: 'bar',
                        marker: { 
                            color: ['#667eea', '#764ba2', '#f093fb', '#4facfe', '#fa709a']
                        },
                        text: [analysis.transfers.avg_time.toFixed(1),
                               travelTimes.metro.avg.toFixed(1),
                               travelTimes.bus.avg.toFixed(1),
                               travelTimes.auto.avg.toFixed(1),
                               travelTimes.mmts.avg.toFixed(1)],
                        textposition: 'outside',
                        texttemplate: '%{text} min'
                    }], {
                        title: 'Average Edge Travel Time by Mode',
                        yaxis: { title: 'Time (minutes)' }
                    }, {responsive: true});
                } else {
                    console.error('Travel times data not available:', travelTimes);
                    document.getElementById('travel-time-chart').innerHTML = '<p style="color: red; padding: 20px;">Error: Travel time data not loaded. Please refresh the page.</p>';
                }

                // 8. Node Connectivity Explorer - Distribution & Table View
                const allNodes = analysis.all_connected_nodes || analysis.top_connected_nodes;
                
                // Group nodes by connectivity level
                function groupNodesByConnectivity() {
                    const grouped = {};
                    allNodes.forEach(node => {
                        if (!grouped[node.degree]) {
                            grouped[node.degree] = [];
                        }
                        grouped[node.degree].push(node);
                    });
                    return grouped;
                }
                
                // Function to render connectivity visualization
                function renderConnectivity(sortDirection) {
                    const grouped = groupNodesByConnectivity();
                    const connectivityLevels = Object.keys(grouped).map(Number).sort((a, b) => 
                        sortDirection === 'desc' ? b - a : a - b
                    );
                    
                    // Prepare data for distribution chart
                    const chartData = connectivityLevels.map(level => ({
                        degree: level,
                        count: grouped[level].length
                    }));
                    
                    // Create distribution bar chart
                    const chartTitle = sortDirection === 'desc' 
                        ? 'Connectivity Distribution (Most to Least Connected)' 
                        : 'Connectivity Distribution (Least to Most Connected)';
                    
                    Plotly.newPlot('connectivity-distribution-chart', [{
                        x: chartData.map(d => `${d.degree} connections`),
                        y: chartData.map(d => d.count),
                        type: 'bar',
                        marker: {
                            color: chartData.map((d, i) => {
                                const colors = ['#667eea', '#764ba2', '#f093fb', '#fa709a', '#4facfe', '#00f2fe'];
                                return colors[i % colors.length];
                            }),
                            line: {
                                color: '#333',
                                width: 1
                            }
                        },
                        text: chartData.map(d => d.count),
                        textposition: 'outside',
                        hovertext: chartData.map(d => `${d.count} nodes with ${d.degree} connections`),
                        hoverinfo: 'text'
                    }], {
                        title: chartTitle,
                        xaxis: { 
                            title: 'Connectivity Level',
                            tickangle: -45
                        },
                        yaxis: { title: 'Number of Nodes' },
                        height: 400
                    }, {responsive: true});
                    
                    // Populate table
                    const tableBody = document.getElementById('connectivity-table-body');
                    tableBody.innerHTML = '';
                    
                    connectivityLevels.forEach((level, index) => {
                        const nodes = grouped[level];
                        const layerColors = {
                            'metro': '#764ba2',
                            'mmts': '#fa709a', 
                            'bus': '#f093fb',
                            'auto': '#4facfe'
                        };
                        
                        // Create node badges
                        const nodeBadges = nodes.map(node => {
                            const color = layerColors[node.layer] || '#999';
                            return `<span style="display: inline-block; margin: 0.2rem; padding: 0.3rem 0.6rem; background: ${color}; color: white; border-radius: 4px; font-size: 0.85rem;" title="${node.layer} - ${node.region}">${node.name}</span>`;
                        }).join('');
                        
                        const row = document.createElement('tr');
                        row.style.backgroundColor = index % 2 === 0 ? '#f9f9f9' : 'white';
                        row.innerHTML = `
                            <td style="padding: 1rem; font-weight: 600; font-size: 1.1rem; color: #667eea; border-bottom: 1px solid #eee;">${level} connections</td>
                            <td style="padding: 1rem; text-align: center; font-weight: 600; font-size: 1.1rem; color: #fa709a; border-bottom: 1px solid #eee;">${nodes.length} node${nodes.length > 1 ? 's' : ''}</td>
                            <td style="padding: 1rem; border-bottom: 1px solid #eee;">${nodeBadges}</td>
                        `;
                        tableBody.appendChild(row);
                    });
                }
                
                // Initial render
                renderConnectivity('desc');
                
                // Add event listener
                document.getElementById('sort-direction').addEventListener('change', function(e) {
                    renderConnectivity(e.target.value);
                });

                // 9. Summary Stats Cards - REMOVED (now static in combined section above)
                // The Network Statistics & Complex Properties section now has static values

                // 10. Network Performance Metrics Grid
                const access = analysis.accessibility;
                const transfers = analysis.transfers;
                const efficiency = analysis.efficiency;
                
                const performanceMetricsHtml = `
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 1.5rem; border-radius: 10px; color: white; text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: bold;">${efficiency.density}%</div>
                        <div style="font-size: 1rem; margin-top: 0.5rem;">Network Density</div>
                        <div style="font-size: 0.85rem; margin-top: 0.3rem; opacity: 0.9;">${analysis.basic.total_edges.toLocaleString()} / ${Math.round(analysis.basic.total_nodes * (analysis.basic.total_nodes - 1) / 2).toLocaleString()} possible edges</div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #f093fb 0%, #fa709a 100%); padding: 1.5rem; border-radius: 10px; color: white; text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: bold;">${efficiency.avg_degree}</div>
                        <div style="font-size: 1rem; margin-top: 0.5rem;">Average Degree</div>
                        <div style="font-size: 0.85rem; margin-top: 0.3rem; opacity: 0.9;">Connections per node</div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 1.5rem; border-radius: 10px; color: white; text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: bold;">${transfers.percentage}%</div>
                        <div style="font-size: 1rem; margin-top: 0.5rem;">Transfer Integration</div>
                        <div style="font-size: 0.85rem; margin-top: 0.3rem; opacity: 0.9;">${transfers.total.toLocaleString()} inter-modal connections</div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); padding: 1.5rem; border-radius: 10px; color: white; text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: bold;">${access.rail_stations}</div>
                        <div style="font-size: 1rem; margin-top: 0.5rem;">Rail Stations</div>
                        <div style="font-size: 0.85rem; margin-top: 0.3rem; opacity: 0.9;">Metro + MMTS network</div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); padding: 1.5rem; border-radius: 10px; color: #333; text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: bold;">${access.coverage_area_km2}</div>
                        <div style="font-size: 1rem; margin-top: 0.5rem;">Coverage Area</div>
                        <div style="font-size: 0.85rem; margin-top: 0.3rem; opacity: 0.8;">Square kilometers</div>
                    </div>
                `;
                document.getElementById('performance-metrics-grid').innerHTML = performanceMetricsHtml;
                
                // 11. Transfer Network Analysis
                console.log(' Creating transfer network chart...');
                const transferTypes = transfers.by_type;
                if (transferTypes) {
                    Plotly.newPlot('transfer-network-chart', [{
                        x: ['Bus  Metro', 'Auto  Metro', 'Auto  Bus', 'Bus  MMTS', 'Auto  MMTS'],
                        y: [transferTypes.bus_metro, transferTypes.auto_metro, transferTypes.auto_bus, transferTypes.bus_mmts, transferTypes.auto_mmts],
                        type: 'bar',
                        marker: {
                            color: ['#764ba2', '#4facfe', '#f093fb', '#fa709a', '#00f2fe']
                        },
                        text: [transferTypes.bus_metro, transferTypes.auto_metro, transferTypes.auto_bus, transferTypes.bus_mmts, transferTypes.auto_mmts],
                        textposition: 'outside'
                    }], {
                    title: 'Inter-Modal Transfer Connections by Type',
                    yaxis: { title: 'Number of Transfer Edges' },
                    height: 400
                }, {responsive: true});
                    console.log(' Transfer network chart created');
                } else {
                    console.error(' Transfer by_type data missing');
                }

                // 12. Rail Accessibility - Detailed Breakdown
                console.log(' Creating accessibility chart...');
                Plotly.newPlot('accessibility-chart', [
                    {
                        name: 'Near Metro',
                        x: ['Bus Stops', 'Auto Stands'],
                        y: [access.bus_near_metro_pct, access.auto_near_metro_pct],
                        type: 'bar',
                        marker: { color: '#764ba2' },
                        text: [access.bus_near_metro_pct + '%', access.auto_near_metro_pct + '%'],
                        textposition: 'outside'
                    },
                    {
                        name: 'Near MMTS',
                        x: ['Bus Stops', 'Auto Stands'],
                        y: [access.bus_near_mmts_pct, access.auto_near_mmts_pct],
                        type: 'bar',
                        marker: { color: '#fa709a' },
                        text: [access.bus_near_mmts_pct + '%', access.auto_near_mmts_pct + '%'],
                        textposition: 'outside'
                    },
                    {
                        name: 'Not Near Rail',
                        x: ['Bus Stops', 'Auto Stands'],
                        y: [access.bus_far_from_rail_pct, access.auto_far_from_rail_pct],
                        type: 'bar',
                        marker: { color: '#e0e0e0' },
                        text: [access.bus_far_from_rail_pct + '%', access.auto_far_from_rail_pct + '%'],
                        textposition: 'outside'
                    }
                ], {
                    title: 'Last-Mile Feeder Accessibilities (within 500m)',
                    yaxis: { title: 'Percentage (%)', range: [0, 100] },
                    barmode: 'group',
                    height: 450,
                    legend: { orientation: 'h', y: -0.15 }
                }, {responsive: true});

                // 13. Quality Indicators
                const qualityHtml = `
                    <li><strong>Network Density:</strong> ${analysis.efficiency.density}% - Indicates how well-connected the network is (${analysis.basic.total_edges.toLocaleString()} actual connections out of ${Math.round(analysis.basic.total_nodes * (analysis.basic.total_nodes - 1) / 2).toLocaleString()} theoretically possible)</li>
                    <li><strong>Average Node Degree:</strong> ${analysis.efficiency.avg_degree} connections per node - Shows the network is highly interconnected with strong redundancy</li>
                    <li><strong>Transfer Integration Rate:</strong> ${analysis.transfers.percentage}% of all edges are inter-modal transfers (${transfers.total.toLocaleString()} transfer connections) - Enables seamless mode switching across the network</li>
                    <li><strong>Metro Accessibility:</strong> ${access.bus_near_metro} (${access.bus_near_metro_pct}%) bus stops and ${access.auto_near_metro} (${access.auto_near_metro_pct}%) auto stands within 500m of ${access.metro_stations} Metro stations</li>
                    <li><strong>MMTS Accessibility:</strong> ${access.bus_near_mmts} (${access.bus_near_mmts_pct}%) bus stops and ${access.auto_near_mmts} (${access.auto_near_mmts_pct}%) auto stands within 500m of ${access.mmts_stations} MMTS stations</li>
                    <li><strong>Isolated Feeders:</strong> ${access.bus_far_from_rail} (${access.bus_far_from_rail_pct}%) bus stops and ${access.auto_far_from_rail} (${access.auto_far_from_rail_pct}%) auto stands are more than 500m from any rail station - These serve areas without rail coverage and rely on direct bus/auto connectivity</li>
                    <li><strong>Geographic Coverage:</strong> ~${access.coverage_area_km2} km² spanning 7 regions of Hyderabad - Extensive spatial reach across the metropolitan area</li>
                `;
                document.getElementById('quality-indicators').innerHTML = qualityHtml;

                // ===== COMPLEX NETWORK VISUALIZATIONS =====
                const cn = analysis.complex_networks;

                // 14. Degree Distribution
                const degDist = cn.degree_distribution.slice(0, 30); // Show top 30 degree values
                Plotly.newPlot('degree-distribution-chart', [{
                    x: degDist.map(d => d.degree),
                    y: degDist.map(d => d.count),
                    type: 'scatter',
                    mode: 'markers+lines',
                    marker: { size: 10, color: '#667eea' },
                    line: { color: '#764ba2', width: 2 }
                }], {
                    title: 'Node Degree Distribution (Power Law Check)',
                    xaxis: { title: 'Degree (Number of Connections)', type: 'log' },
                    yaxis: { title: 'Number of Nodes', type: 'log' },
                    annotations: [{
                        text: 'Log-log scale reveals scale-free properties',
                        xref: 'paper', yref: 'paper',
                        x: 0.5, y: 1.1,
                        showarrow: false,
                        font: { size: 12, color: '#666' }
                    }]
                }, {responsive: true});

                // 13. Clustering Coefficient by Layer
                const clustering = cn.clustering_by_layer;
                Plotly.newPlot('clustering-chart', [{
                    x: ['Metro', 'MMTS', 'Bus', 'Auto'],
                    y: [clustering.metro, clustering.mmts, clustering.bus, clustering.auto],
                    type: 'bar',
                    marker: {
                        color: ['#764ba2', '#fa709a', '#f093fb', '#4facfe']
                    },
                    text: [clustering.metro, clustering.mmts, clustering.bus, clustering.auto],
                    textposition: 'outside',
                    texttemplate: '%{text}'
                }], {
                    title: 'Clustering Coefficient by Layer',
                    yaxis: { title: 'Clustering Coefficient', range: [0, 1] },
                    annotations: [{
                        text: `Network Average: ${cn.clustering_coefficient}`,
                        xref: 'paper', yref: 'paper',
                        x: 0.5, y: 1.05,
                        showarrow: false,
                        font: { size: 14, color: '#667eea', weight: 'bold' }
                    }]
                }, {responsive: true});

                // Small-World Metrics - UPDATED with Comprehensive Analysis
                const swTest = cn.network_classification.small_world_test;
                const ncSigma = cn.network_classification.sigma;
                
                const smallWorldHtml = `
                    <div style="padding: 0.8rem; margin: 0.8rem 0; background: linear-gradient(135deg, #e8f5e9 0%, #f1f8e9 100%); border-left: 5px solid #4caf50; border-radius: 8px;">
                        <strong style="color: #2e7d32; font-size: 1.1rem;"> SMALL-WORLD CONFIRMED</strong><br>
                        <span style="font-size: 1.3rem; color: #4caf50; font-weight: bold;">σ = ${ncSigma.toFixed(2)}</span>
                        <span style="font-size: 0.9rem; color: #666; margin-left: 0.5rem;">(>1 = small-world)</span>
                    </div>
                    <div style="padding: 0.5rem; margin: 0.5rem 0; background: #f0f4ff; border-left: 4px solid #667eea;">
                        <strong>Clustering Coefficient:</strong> ${cn.clustering_coefficient}
                        <span style="color: #4caf50; margin-left: 0.5rem;">
                            (${(swTest.clustering_ratio).toFixed(1)}x higher than random!)
                        </span>
                    </div>
                    <div style="padding: 0.5rem; margin: 0.5rem 0; background: #f0f4ff; border-left: 4px solid #764ba2;">
                        <strong>Avg Path Length:</strong> ${cn.avg_shortest_path} hops
                        <span style="color: #2196f3; margin-left: 0.5rem;">
                            (${(swTest.path_ratio).toFixed(2)}x vs random)
                        </span>
                    </div>
                    <div style="padding: 0.5rem; margin: 0.5rem 0; background: #f0f4ff; border-left: 4px solid #f093fb;">
                        <strong>Network Diameter:</strong> ${cn.diameter_estimate} hops
                    </div>
                    <div style="padding: 0.5rem; margin: 0.5rem 0; background: #fff3e0; border-left: 4px solid #ff9800;">
                        <strong>Random Network Clustering:</strong> ${swTest.C_random.toFixed(4)}
                    </div>
                    <div style="padding: 0.5rem; margin: 0.5rem 0; background: #fff3e0; border-left: 4px solid #ff9800;">
                        <strong>Random Network Path Length:</strong> ${swTest.L_random.toFixed(2)} hops
                    </div>
                    <div style="padding: 1rem; margin: 1rem 0; background: linear-gradient(135deg, #4caf50 0%, #81c784 100%); border-radius: 8px; color: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <strong style="font-size: 1.1rem;"> Small-World Formula:</strong><br>
                        <span style="font-size: 0.95rem; font-family: monospace; background: rgba(255,255,255,0.2); padding: 0.3rem 0.5rem; border-radius: 4px; display: inline-block; margin-top: 0.5rem;">
                            σ = (C<sub>real</sub>/${swTest.C_real.toFixed(4)} ÷ C<sub>random</sub>/${swTest.C_random.toFixed(4)}) ÷ (L<sub>real</sub>/${swTest.L_real.toFixed(2)} ÷ L<sub>random</sub>/${swTest.L_random.toFixed(2)}) = ${ncSigma.toFixed(2)}
                        </span>
                    </div>
                `;
                document.getElementById('small-world-metrics').innerHTML = smallWorldHtml;
                
                // Also populate the dedicated small-world detail fields
                if (document.getElementById('sw-clustering-value')) {
                    document.getElementById('sw-clustering-value').textContent = swTest.C_real.toFixed(4);
                    document.getElementById('sw-random-clustering').textContent = swTest.C_random.toFixed(4);
                    document.getElementById('sw-clustering-ratio').textContent = swTest.clustering_ratio.toFixed(2) + 'x higher!';
                    document.getElementById('sw-path-value').textContent = swTest.L_real.toFixed(2);
                    document.getElementById('sw-random-path').textContent = swTest.L_random.toFixed(2);
                    document.getElementById('sw-path-ratio').textContent = swTest.path_ratio.toFixed(2) + 'x longer';
                    document.getElementById('sw-sigma-value').textContent = ncSigma.toFixed(2);
                    document.getElementById('sw-sigma-value-2').textContent = ncSigma.toFixed(2);
                }

                // Scale-Free Analysis Results
                const sf = cn.scale_free;
                const verdictColor = sf.is_scale_free ? '#4caf50' : '#f44336';
                const verdictIcon = sf.is_scale_free ? '' : '';
                const verdictText = sf.is_scale_free ? 'SCALE-FREE' : 'NOT SCALE-FREE';
                
                const scaleVerdictHtml = `
                    <div style="padding: 2rem; background: ${verdictColor}15; border: 3px solid ${verdictColor}; border-radius: 12px;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">${verdictIcon}</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: ${verdictColor}; margin-bottom: 1rem;">
                            ${verdictText}
                        </div>
                        <div style="font-size: 1.1rem; color: #666;">
                            ${sf.criteria_passed} / ${sf.criteria_total} criteria passed
                        </div>
                        <div style="margin-top: 1rem; font-size: 0.9rem; color: #666; font-style: italic;">
                            ${sf.is_scale_free 
                                ? 'Network exhibits power-law characteristics' 
                                : 'Network does not follow power-law distribution'}
                        </div>
                    </div>
                `;
                
                const scaleStatsHtml = `
                    <div style="padding: 0.5rem; margin: 0.5rem 0; background: #f0f4ff; border-left: 4px solid #667eea;">
                        <strong>Gamma (γ):</strong> ${sf.gamma.toFixed(4)}
                        <span style="color: ${(sf.gamma >= 2 && sf.gamma <= 3) ? '#4caf50' : '#f44336'}; margin-left: 0.5rem;">
                            ${(sf.gamma >= 2 && sf.gamma <= 3) ? '' : ''} 
                            ${(sf.gamma >= 2 && sf.gamma <= 3) ? 'In range [2, 3]' : 'Out of range [2, 3]'}
                        </span>
                    </div>
                    <div style="padding: 0.5rem; margin: 0.5rem 0; background: #f0f4ff; border-left: 4px solid #764ba2;">
                        <strong>R² Score:</strong> ${sf.r_squared.toFixed(4)}
                        <span style="color: ${sf.r_squared > 0.5 ? '#4caf50' : '#f44336'}; margin-left: 0.5rem;">
                            ${sf.r_squared > 0.5 ? '' : ''} 
                            ${sf.r_squared > 0.5 ? 'Good fit' : 'Poor fit'}
                        </span>
                    </div>
                    <div style="padding: 0.5rem; margin: 0.5rem 0; background: #f0f4ff; border-left: 4px solid #f093fb;">
                        <strong>KS Statistic:</strong> ${sf.ks_statistic.toFixed(4)}
                        <span style="color: ${sf.ks_statistic < 0.15 ? '#4caf50' : '#f44336'}; margin-left: 0.5rem;">
                            ${sf.ks_statistic < 0.15 ? '' : ''} 
                            ${sf.ks_statistic < 0.15 ? 'Passes KS test' : 'Fails KS test'}
                        </span>
                    </div>
                    <div style="padding: 0.5rem; margin: 0.5rem 0; background: #fff3e0; border-left: 4px solid #ff9800;">
                        <strong>Alternative γ (log-log):</strong> ${sf.gamma_loglog.toFixed(4)}
                    </div>
                    <div style="padding: 0.5rem; margin: 0.5rem 0; background: #fff3e0; border-left: 4px solid #ff9800;">
                        <strong>R² (log-log):</strong> ${sf.r_squared_loglog.toFixed(4)}
                    </div>
                `;
                
                document.getElementById('scale-free-verdict').innerHTML = scaleVerdictHtml;
                document.getElementById('scale-free-stats').innerHTML = scaleStatsHtml;

                // Comprehensive Network Classification
                const nc = cn.network_classification;
                
                // Primary type verdict
                const typeColors = {
                    'SCALE-FREE': '#9c27b0',
                    'RANDOM': '#ff9800',
                    'SMALL-WORLD': '#4caf50',
                    'REGULAR': '#2196f3',
                    'COMPLETE': '#f44336',
                    'COMPLEX': '#607d8b'
                };
                
                const typeIcons = {
                    'SCALE-FREE': '',
                    'RANDOM': '',
                    'SMALL-WORLD': '',
                    'REGULAR': '',
                    'COMPLETE': '',
                    'COMPLEX': ''
                };
                
                const primaryType = nc.primary_type;
                const primaryColor = typeColors[primaryType] || '#667eea';
                const primaryIcon = typeIcons[primaryType] || '';
                
                const networkTypeVerdictHtml = `
                    <div style="padding: 2rem;">
                        <div style="font-size: 4rem; margin-bottom: 1rem;">${primaryIcon}</div>
                        <div style="font-size: 2rem; font-weight: bold; color: ${primaryColor}; margin-bottom: 1rem;">
                            ${primaryType}
                        </div>
                        <div style="font-size: 1.2rem; color: #666; margin-bottom: 1rem;">
                            Network Type
                        </div>
                        ${nc.all_types.length > 1 ? `
                            <div style="font-size: 0.9rem; color: #999; margin-top: 1rem;">
                                Also exhibits: ${nc.all_types.slice(1).join(', ')}
                            </div>
                        ` : ''}
                        <div style="margin-top: 1.5rem; font-size: 1rem;">
                            <strong>Small-World Sigma:</strong> ${nc.sigma.toFixed(2)}
                        </div>
                    </div>
                `;
                
                const allTestsHtml = `
                    <h3 style="margin-bottom: 1rem;">All Network Type Tests</h3>
                    <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                        <div style="display: flex; align-items: center; padding: 0.8rem; background: ${sf.is_scale_free ? '#e8f5e9' : '#ffebee'}; border-radius: 8px;">
                            <span style="font-size: 1.5rem; margin-right: 1rem;">${sf.is_scale_free ? '' : ''}</span>
                            <div>
                                <strong>Scale-Free</strong><br>
                                <small style="color: #666;">γ = ${sf.gamma.toFixed(2)}, ${sf.criteria_passed}/3 criteria</small>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; padding: 0.8rem; background: ${nc.is_random ? '#e8f5e9' : '#ffebee'}; border-radius: 8px;">
                            <span style="font-size: 1.5rem; margin-right: 1rem;">${nc.is_random ? '' : ''}</span>
                            <div>
                                <strong>Random (Erdős-Rényi)</strong><br>
                                <small style="color: #666;">Poisson p-value: ${nc.random_test.poisson_p_value.toFixed(4)}</small>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; padding: 0.8rem; background: ${nc.is_small_world ? '#e8f5e9' : '#ffebee'}; border-radius: 8px;">
                            <span style="font-size: 1.5rem; margin-right: 1rem;">${nc.is_small_world ? '' : ''}</span>
                            <div>
                                <strong>Small-World</strong><br>
                                <small style="color: #666;">σ = ${nc.sigma.toFixed(2)} (>1 = small-world)</small>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; padding: 0.8rem; background: ${nc.is_regular ? '#e8f5e9' : '#ffebee'}; border-radius: 8px;">
                            <span style="font-size: 1.5rem; margin-right: 1rem;">${nc.is_regular ? '' : ''}</span>
                            <div>
                                <strong>Regular</strong><br>
                                <small style="color: #666;">${nc.is_regular ? 'All nodes same degree' : 'Variable degrees'}</small>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; padding: 0.8rem; background: ${nc.is_complete ? '#e8f5e9' : '#ffebee'}; border-radius: 8px;">
                            <span style="font-size: 1.5rem; margin-right: 1rem;">${nc.is_complete ? '' : ''}</span>
                            <div>
                                <strong>Complete</strong><br>
                                <small style="color: #666;">${nc.is_complete ? 'Fully connected' : 'Not fully connected'}</small>
                            </div>
                        </div>
                    </div>
                `;
                
                // Classification explanation
                const explanations = {
                    'SMALL-WORLD': `
                        <p><strong>Your network is a SMALL-WORLD network!</strong> This is excellent for urban transportation.</p>
                        <ul style="margin-top: 1rem; line-height: 1.8;">
                            <li><strong>High Clustering (${(nc.small_world_test.C_real).toFixed(4)}):</strong> Strong local connectivity - neighborhoods are well-connected</li>
                            <li><strong>Short Path Lengths (${(nc.small_world_test.L_real).toFixed(2)} hops):</strong> Can reach any destination relatively quickly</li>
                            <li><strong>Sigma = ${nc.sigma.toFixed(2)}:</strong> Clustering is ${nc.sigma.toFixed(1)}x higher than random, while paths stay short</li>
                            <li><strong>Real-World Parallel:</strong> Like social networks and brain networks - efficient information flow</li>
                            <li><strong>Benefits:</strong> Resilient, efficient routing, good community structure</li>
                        </ul>
                        <p style="margin-top: 1rem;"><em>This structure emerges naturally in well-designed transport systems!</em></p>
                    `,
                    'SCALE-FREE': `
                        <p><strong>Your network is SCALE-FREE!</strong> Characterized by hub-and-spoke structure.</p>
                        <ul style="margin-top: 1rem; line-height: 1.8;">
                            <li><strong>Hub Structure:</strong> Few nodes with many connections (major stations)</li>
                            <li><strong>Power-Law Distribution:</strong> P(k) ∝ k<sup>-γ</sup> where γ = ${sf.gamma.toFixed(2)}</li>
                            <li><strong>Real-World Examples:</strong> Internet, airline networks, social media</li>
                            <li><strong>Trade-off:</strong> Efficient but vulnerable to targeted hub attacks</li>
                        </ul>
                    `,
                    'RANDOM': `
                        <p><strong>Your network resembles a RANDOM (Erdős-Rényi) graph.</strong></p>
                        <ul style="margin-top: 1rem; line-height: 1.8;">
                            <li><strong>Poisson Degree Distribution:</strong> Connections are relatively uniform</li>
                            <li><strong>Low Clustering:</strong> Few local communities</li>
                            <li><strong>Short Paths:</strong> Efficient routing globally</li>
                            <li><strong>Unusual for Transport:</strong> Most real networks are NOT random</li>
                        </ul>
                    `,
                    'COMPLEX': `
                        <p><strong>Your network is COMPLEX</strong> - doesn't fit standard models perfectly.</p>
                        <p style="margin-top: 1rem;">This is common for real-world networks that exhibit mixed properties.</p>
                    `
                };
                
                const classificationExplanation = explanations[primaryType] || explanations['COMPLEX'];
                
                document.getElementById('network-type-verdict').innerHTML = networkTypeVerdictHtml;
                document.getElementById('all-network-tests').innerHTML = allTestsHtml;
                document.getElementById('classification-explanation').innerHTML = classificationExplanation;

                // LOAD COMPREHENSIVE CENTRALITY DATA
                fetch('centrality_analysis_complete.json')
                    .then(response => response.json())
                    .then(centralityData => {
                        console.log(' Centrality data loaded');
                        
                        const layerColors = {
                            'metro': '#764ba2',
                            'mmts': '#fa709a',
                            'bus': '#f093fb',
                            'auto': '#4facfe',
                            'unknown': '#999'
                        };
                        
                        // 1. DEGREE CENTRALITY - Top 10
                        const degreeTop = centralityData.degree_centrality.top_10;
                        Plotly.newPlot('degree-top-chart', [{
                            x: degreeTop.map(n => n.degree),
                            y: degreeTop.map(n => n.name),
                            type: 'bar',
                            orientation: 'h',
                            marker: {
                                color: degreeTop.map(n => layerColors[n.layer] || layerColors.unknown),
                                line: { color: '#333', width: 1 }
                            },
                            text: degreeTop.map(n => `${n.degree} (${n.degree_centrality.toFixed(3)})`),
                            textposition: 'outside',
                            hovertext: degreeTop.map(n => 
                                `${n.name}<br>Layer: ${n.layer}<br>Degree: ${n.degree}<br>Normalized: ${n.degree_centrality.toFixed(4)}`
                            ),
                            hoverinfo: 'text'
                        }], {
                            xaxis: { title: 'Number of Connections' },
                            yaxis: { automargin: true },
                            height: 500,
                            margin: { l: 150, r: 80, t: 30, b: 50 }
                        }, {responsive: true});
                        
                        // 2. BETWEENNESS CENTRALITY - Top 10
                        const betweennessTop = centralityData.betweenness_centrality.top_10;
                        Plotly.newPlot('betweenness-top-chart', [{
                            x: betweennessTop.map(n => n.betweenness),
                            y: betweennessTop.map(n => n.name),
                            type: 'bar',
                            orientation: 'h',
                            marker: {
                                color: betweennessTop.map(n => layerColors[n.layer] || layerColors.unknown),
                                line: { color: '#333', width: 1 }
                            },
                            text: betweennessTop.map(n => n.betweenness.toFixed(4)),
                            textposition: 'outside',
                            hovertext: betweennessTop.map(n => 
                                `${n.name}<br>Layer: ${n.layer}<br>Betweenness: ${n.betweenness.toFixed(6)}`
                            ),
                            hoverinfo: 'text'
                        }], {
                            xaxis: { title: 'Normalized Betweenness Centrality' },
                            yaxis: { automargin: true },
                            height: 500,
                            margin: { l: 150, r: 80, t: 30, b: 50 }
                        }, {responsive: true});
                        
                        // 3. CLOSENESS CENTRALITY - Top 10
                        const closenessTop = centralityData.closeness_centrality.top_10;
                        Plotly.newPlot('closeness-top-chart', [{
                            x: closenessTop.map(n => n.closeness),
                            y: closenessTop.map(n => n.name),
                            type: 'bar',
                            orientation: 'h',
                            marker: {
                                color: closenessTop.map(n => layerColors[n.layer] || layerColors.unknown),
                                line: { color: '#333', width: 1 }
                            },
                            text: closenessTop.map(n => n.closeness.toFixed(4)),
                            textposition: 'outside',
                            hovertext: closenessTop.map(n => 
                                `${n.name}<br>Layer: ${n.layer}<br>Closeness: ${n.closeness.toFixed(6)}`
                            ),
                            hoverinfo: 'text'
                        }], {
                            xaxis: { title: 'Normalized Closeness Centrality' },
                            yaxis: { automargin: true },
                            height: 500,
                            margin: { l: 150, r: 80, t: 30, b: 50 }
                        }, {responsive: true});
                        
                        // 4. EIGENVECTOR CENTRALITY - Top 10
                        const eigenvectorTop = centralityData.eigenvector_centrality.top_10;
                        Plotly.newPlot('eigenvector-top-chart', [{
                            x: eigenvectorTop.map(n => n.eigenvector),
                            y: eigenvectorTop.map(n => n.name),
                            type: 'bar',
                            orientation: 'h',
                            marker: {
                                color: eigenvectorTop.map(n => layerColors[n.layer] || layerColors.unknown),
                                line: { color: '#333', width: 1 }
                            },
                            text: eigenvectorTop.map(n => n.eigenvector.toFixed(4)),
                            textposition: 'outside',
                            hovertext: eigenvectorTop.map(n => 
                                `${n.name}<br>Layer: ${n.layer}<br>Eigenvector: ${n.eigenvector.toFixed(6)}`
                            ),
                            hoverinfo: 'text'
                        }], {
                            xaxis: { title: 'Eigenvector Centrality' },
                            yaxis: { automargin: true },
                            height: 500,
                            margin: { l: 150, r: 80, t: 30, b: 50 }
                        }, {responsive: true});
                        
                        // 5. CLUSTERING COEFFICIENT - Top 10
                        const clusteringTop = centralityData.clustering_coefficient.top_10;
                        Plotly.newPlot('clustering-top-chart', [{
                            x: clusteringTop.map(n => n.clustering),
                            y: clusteringTop.map(n => n.name),
                            type: 'bar',
                            orientation: 'h',
                            marker: {
                                color: clusteringTop.map(n => layerColors[n.layer] || layerColors.unknown),
                                line: { color: '#333', width: 1 }
                            },
                            text: clusteringTop.map(n => n.clustering.toFixed(4)),
                            textposition: 'outside',
                            hovertext: clusteringTop.map(n => 
                                `${n.name}<br>Layer: ${n.layer}<br>Degree: ${n.degree}<br>Clustering: ${n.clustering.toFixed(6)}`
                            ),
                            hoverinfo: 'text'
                        }], {
                            xaxis: { title: 'Local Clustering Coefficient', range: [0, 1] },
                            yaxis: { automargin: true },
                            height: 500,
                            margin: { l: 150, r: 80, t: 30, b: 50 }
                        }, {responsive: true});
                        
                    })
                    .catch(error => {
                        console.error('Error loading centrality data:', error);
                        alert('Error loading comprehensive centrality analysis. Please run calculate_all_centralities.py first.');
                    });

                // 17. Assortativity - REMOVED (assortativity section was deleted)
                // This section has been removed from the dashboard

                // 18. Network Resilience - REMOVED (resilience section was deleted)  
                // This section has been removed from the dashboard

                /* COMMENTED OUT - Sections removed from HTML
                const assort = cn.assortativity_coefficient;
                document.getElementById('assortativity-value').innerHTML = assort.toFixed(4);
                let assortInterpretation = '';
                if (assort > 0.1) {
                    assortInterpretation = '<span style="color: #4caf50;">Assortative Mixing</span><br><small>Hubs connect to hubs</small>';
                } else if (assort < -0.1) {
                    assortInterpretation = '<span style="color: #f44336;">Disassortative Mixing</span><br><small>Hub-and-spoke pattern</small>';
                } else {
                    assortInterpretation = '<span style="color: #ff9800;">Random Mixing</span><br><small>No preference</small>';
                }
                document.getElementById('assortativity-interpretation').innerHTML = assortInterpretation;

                // 18. Network Resilience
                const resilience = cn.resilience;
                Plotly.newPlot('resilience-chart', [{
                    x: ['Original<br>Network', 'After Targeted<br>Attack (5%)', 'After Random<br>Failure (5%)'],
                    y: [
                        resilience.originally_connected ? 100 : 0,
                        resilience.after_targeted_attack ? 100 : 0,
                        resilience.after_random_failure ? 100 : 0
                    ],
                    type: 'bar',
                    marker: {
                        color: [
                            '#4caf50',
                            resilience.after_targeted_attack ? '#4caf50' : '#f44336',
                            resilience.after_random_failure ? '#4caf50' : '#f44336'
                        ]
                    },
                    text: [
                        resilience.originally_connected ? 'Connected' : 'Fragmented',
                        resilience.after_targeted_attack ? 'Connected' : 'Fragmented',
                        resilience.after_random_failure ? 'Connected' : 'Fragmented'
                    ],
                    textposition: 'outside',
                    hovertext: [
                        'Full network connectivity',
                        `Removed top ${resilience.nodes_removed_percent}% highest-degree nodes`,
                        `Removed random ${resilience.nodes_removed_percent}% of nodes`
                    ],
                    hoverinfo: 'text'
                }], {
                    title: 'Network Resilience Under Node Removal',
                    yaxis: { title: 'Connectivity Status (%)', range: [0, 120] },
                    annotations: [{
                        text: resilience.vulnerability_score === 0 ? 
                              ' Network resilient to 5% node removal' : 
                              ' Network vulnerable to targeted attacks',
                        xref: 'paper', yref: 'paper',
                        x: 0.5, y: 1.05,
                        showarrow: false,
                        font: { 
                            size: 14, 
                            color: resilience.vulnerability_score === 0 ? '#4caf50' : '#f44336',
                            weight: 'bold'
                        }
                    }]
                }, {responsive: true});

                // 19. Complex Network Summary - REMOVED (now static in combined section)
                // This data is now displayed in the static "Network Statistics & Complex Properties" section
                */

            } catch (error) {
                console.error('Error loading analytics:', error);
            }
        }

        // Render basic charts
        function renderCharts() {
            // Composition chart
            Plotly.newPlot('composition-chart', [{
                labels: ['Metro', 'MMTS', 'Bus', 'Auto'],
                values: [57, 46, 200, 372],
                type: 'pie',
                marker: {
                    colors: ['#764ba2', '#fa709a', '#f093fb', '#4facfe']
                },
                textinfo: 'label+percent+value',
                hole: 0.4
            }], {
                title: 'Node Distribution by Layer',
                annotations: [{
                    text: '675<br>Total',
                    x: 0.5, y: 0.5,
                    font: { size: 20, color: '#667eea' },
                    showarrow: false
                }]
            }, {responsive: true});

            // Edge distribution
            const edgeValues = [3068, 1817, 1194, 112, 92];
            Plotly.newPlot('edge-dist-chart', [{
                x: ['Transfer', 'Auto', 'Bus', 'Metro', 'MMTS'],
                y: edgeValues,
                type: 'bar',
                marker: {
                    color: ['#667eea', '#4facfe', '#f093fb', '#764ba2', '#fa709a']
                },
                text: edgeValues,
                textposition: 'outside'
            }], {
                title: 'Edge Count by Mode',
                yaxis: { title: 'Number of Edges' }
            }, {responsive: true});
        }

        // Initialize
        window.addEventListener('load', () => {
            renderCharts();
            loadAnalytics();
        });
    </script>
</body>
</html>
